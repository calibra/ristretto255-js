!function(r){"use strict";var t="undefined"!=typeof self?self.crypto||self.msCrypto:null;t&&t.getRandomValues||"undefined"==typeof require||(t=require("crypto"));var e=self.nacl;"undefined"!=typeof module&&(e=require("./nacl"));var A=e.lowlevel,w=A.gf([1]),a=new Float64Array([235,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function g(r,t,f){var n,o,e=new Float64Array(64);for(n=0;n<64;n++)e[n]=0;for(n=0;n<32;n++)for(o=0;o<32;o++)e[n+o]+=t[n]*f[o];A.modL(r,e)}var h=A.gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]),y=A.gf([11803,18811,63136,32407,21693,7032,36364,44957,53757,12789,64713,3900,18604,11139,12735,14185]),Z=A.gf([16618,32861,64938,39368,29374,23105,5655,40239,55360,65025,31633,5826,64674,53167,35077,30828]),p=A.gf([49526,37983,2497,57980,13583,52574,41272,11393,57316,48752,43997,39316,57559,45747,29352,656]),m=A.gf([19744,17645,23210,12717,6553,45086,18988,53918,20203,21147,54063,19676,8769,63084,45946,22888]);function l(r){var t=new Uint8Array(32);A.pack25519(t,r);for(var f=1,n=0;n<32;n++)f&=0==t[n];return f}function F(r,t,f){for(var n,o=-f,e=0;e<16;e++)n=r[e]^t[e],n&=o,r[e]^=n}function S(r){var t=new Uint8Array(32);return A.pack25519(t,r),1&t[0]}function b(r,t){A.Z(r,A.gf(),t)}function k(r,t,f){var n=A.gf();b(n,t),A.set25519(r,t),F(r,n,f)}function I(r,t){k(r,t,S(t))}function L(r,t,f){var n,o,e,a=A.gf(),g=A.gf(),u=A.gf(),i=A.gf(),c=A.gf(),s=A.gf();return A.S(a,f),A.M(a,a,f),A.S(r,a),A.M(r,r,f),A.M(r,r,t),A.pow2523(r,r),A.M(r,r,a),A.M(r,r,t),A.S(g,r),A.M(g,g,f),A.Z(u,g,t),A.A(i,g,t),A.M(c,t,h),A.A(c,g,c),n=l(u),o=l(i),e=l(c),A.M(s,r,h),F(r,s,o|e),I(r,r),n|o}function u(r){var t,f=A.gf(),n=A.gf(),o=A.gf(),e=A.gf(),a=A.gf(),g=A.gf(),u=A.gf(),i=(A.gf(),A.gf()),c=A.gf(),s=A.gf(),_=A.gf(),l=A.gf(),v=A.gf(),M=A.gf(),d=A.gf(),y=A.gf(),p=A.gf(),m=new Uint8Array(32);return A.A(s,r[2],r[1]),A.Z(p,r[2],r[1]),A.M(s,s,p),A.M(_,r[0],r[1]),A.S(l,_),A.M(l,s,l),L(a,w,l),A.M(f,a,s),A.M(n,a,_),A.M(y,f,n),A.M(y,y,r[3]),A.M(g,r[0],h),A.M(u,r[1],h),A.M(e,f,Z),A.M(c,r[3],y),t=S(c),v=A.gf(r[0]),M=A.gf(r[1]),o=A.gf(n),F(v,u,t),F(M,g,t),F(o,e,t),A.M(d,v,y),k(M,M,S(d)),A.Z(i,r[2],M),A.M(i,o,i),I(i,i),A.pack25519(m,i),m}function i(r,t){var f,n=A.gf(),o=A.gf(),e=A.gf(),a=A.gf(),g=A.gf(),u=A.gf(),i=A.gf(),c=A.gf(),s=A.gf(),_=A.gf();return 0==function(r){var t,f;for(t=127&r[31]^127,f=30;0<f;f--)t|=255^r[f];return 1-(1&((t=(0|t)-1>>8)&236-(0|r[0])>>8|r[0]))}(t)?-1:(A.unpack25519(e,t),A.S(a,e),A.set25519(g,w),A.Z(g,g,a),A.S(i,g),A.set25519(u,w),A.A(u,u,a),A.S(c,u),A.M(s,A.D,i),b(s,s),A.Z(s,s,c),A.M(_,s,c),A.set25519(o,w),f=L(n,o,_),A.M(r[0],n,u),A.M(r[1],n,r[0]),A.M(r[1],r[1],s),A.M(r[0],r[0],e),A.A(r[0],r[0],r[0]),I(r[0],r[0]),A.M(r[1],g,r[1]),A.set25519(r[2],w),A.M(r[3],r[0],r[1]),-(1-f|S(r[3])|l(r[1])))}function c(r,t){var f,n=A.gf(),o=A.gf(),e=A.gf(),a=A.gf(),g=A.gf(),u=A.gf(),i=A.gf(),c=A.gf(),s=A.gf(),_=A.gf(),l=A.gf(),v=A.gf(),M=A.gf(),d=A.gf();A.set25519(e,w),A.S(a,t),A.M(a,h,a),A.A(s,a,e),A.M(s,s,p),A.set25519(n,w),b(n,n),A.A(g,a,A.D),A.M(_,a,A.D),A.Z(_,n,_),A.M(_,_,g),f=1-L(u,s,_),A.M(i,u,t),I(i,i),b(i,i),F(u,i,f),F(n,a,f),A.Z(o,a,e),A.M(o,o,n),A.M(o,o,m),A.Z(o,o,_),A.A(l,u,u),A.M(l,l,_),A.M(v,o,y),A.S(c,u),A.Z(M,e,c),A.A(d,e,c),A.M(r[0],l,d),A.M(r[1],M,v),A.M(r[2],v,d),A.M(r[3],l,M)}function f(r){var t=A.gf(),f=A.gf(),n=[A.gf(),A.gf(),A.gf(),A.gf()],o=[A.gf(),A.gf(),A.gf(),A.gf()];return A.unpack25519(t,r.slice(0,32)),A.unpack25519(f,r.slice(32,64)),c(n,t),c(o,f),A.add(n,o),n}function s(r,t){var f=A.gf();b(f,t[3]);var n=A.gf();b(n,t[0]);var o=[n,t[1],t[2],f];A.add(r,o)}function n(){return f(e.randomBytes(64))}function o(r){var t,f=new Float64Array(64);for(t=0;t<32;t++)f[t]=r[t];A.modL(r,f)}function _(r){var t,f=new Float64Array(32);for(t=0;t<32;t++)f[t]=-r[t];return o(f),f}function v(r,t){var f,n=new Float64Array(32);for(f=0;f<32;f++)n[f]=r[f]+t[f];return o(n),n}r.crypto_scalarmult_ristretto255_base=function(r){var t=[A.gf(),A.gf(),A.gf(),A.gf()];return A.scalarbase(t,r),u(t)},r.crypto_scalarmult_ristretto255=function(r,t){var f=[A.gf(),A.gf(),A.gf(),A.gf()],n=[A.gf(),A.gf(),A.gf(),A.gf()];if(0!=i(n,t))throw"Invalid argument";return A.scalarmult(f,n,r),u(f)},r.crypto_core_ristretto255_is_valid_point=function(r){return-1==i([A.gf(),A.gf(),A.gf(),A.gf()],r)?0:1},r.crypto_core_ristretto255_add=function(r,t){var f=[A.gf(),A.gf(),A.gf(),A.gf()],n=[A.gf(),A.gf(),A.gf(),A.gf()];if(-1==i(f,r))throw"Invalid argument";if(-1==i(n,t))throw"Invalid argument";var o=[f[0],f[1],f[2],f[3]];return A.add(o,n),u(o)},r.crypto_core_ristretto255_sub=function(r,t){var f=[A.gf(),A.gf(),A.gf(),A.gf()],n=[A.gf(),A.gf(),A.gf(),A.gf()];if(-1==i(f,r))throw"Invalid argument";if(-1==i(n,t))throw"Invalid argument";var o=[f[0],f[1],f[2],f[3]];return s(o,n),u(o)},r.crypto_core_ristretto255_from_hash=function(r){return u(f(r))},r.crypto_core_ristretto255_random=function(){return u(n())},r.crypto_core_ristretto255_scalar_random=function(){var r=new Uint8Array(32);do{(r=e.randomBytes(32))[31]&=31;for(var t=32,f=1,n=0;n|=r[--t]-A.L[t]>>8&f,f&=(r[t]^A.L[t])-1>>8,0!=t;);}while(0==n);var o=new Float64Array(32);for(t=0;t<32;t++)o[t]=r[t];return o},r.crypto_core_ristretto255_scalar_invert=function(r){var t=new Float64Array(32);return function(r,t){var f,n,o=new Float64Array(32);for(f=0;f<32;f++)o[f]=t[f];for(f=251;0<=f;f--)g(o,n=o,n),0!=(a[f>>3]>>>(7&f)&1)&&g(o,o,t);for(f=0;f<32;f++)r[f]=o[f]}(t,r),t},r.crypto_core_ristretto255_scalar_negate=_,r.crypto_core_ristretto255_scalar_add=v,r.crypto_core_ristretto255_scalar_sub=function(r,t){return v(r,_(t))},r.crypto_core_ristretto255_scalar_mul=function(r,t){var f=new Float64Array(32);return g(f,r,t),f},r.ristretto255_from_hash=f,r.ristretto255_tobytes=u,r.ristretto255_frombytes=i,r.sub=s,r.ristretto255_random=n}("undefined"!=typeof module&&module.exports?module.exports:self.ristretto=self.ristretto||{});
!function(f){"use strict";function r(f){var r,g=new Float64Array(32);if(f)for(r=0;r<f.length;r++)g[r]=f[r];return g}var Z=require("./nacl").lowlevel,w=Z.gf([1]),o=new Float64Array([235,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),g=r([1]);function e(f,r,g){var t,n,o=new Float64Array(64);for(t=0;t<64;t++)o[t]=0;for(t=0;t<32;t++)for(n=0;n<32;n++)o[t+n]+=r[t]*g[n];var e=0;for(n=0;n<64;n++)o[n]+=e,e=o[n]>>8,o[n]&=255;Z.modL(f,o)}var S=Z.gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]),m=Z.gf([11803,18811,63136,32407,21693,7032,36364,44957,53757,12789,64713,3900,18604,11139,12735,14185]),k=Z.gf([16618,32861,64938,39368,29374,23105,5655,40239,55360,65025,31633,5826,64674,53167,35077,30828]),p=Z.gf([49526,37983,2497,57980,13583,52574,41272,11393,57316,48752,43997,39316,57559,45747,29352,656]),y=Z.gf([19744,17645,23210,12717,6553,45086,18988,53918,20203,21147,54063,19676,8769,63084,45946,22888]);function v(f){var r=new Uint8Array(32);Z.pack25519(r,f);for(var g=1,t=0;t<32;t++)g&=0==r[t];return g}function L(f,r,g){for(var t,n=-g,o=0;o<16;o++)t=f[o]^r[o],t&=n,f[o]^=t}function F(f){var r=new Uint8Array(32);return Z.pack25519(r,f),1&r[0]}function _(f,r){Z.Z(f,Z.gf(),r)}function h(f,r,g){var t=Z.gf();_(t,r),Z.set25519(f,r),L(f,t,g)}function D(f,r){h(f,r,F(r))}function U(f,r,g){var t,n,o,e=Z.gf(),M=Z.gf(),a=Z.gf(),u=Z.gf(),i=Z.gf(),c=Z.gf();return Z.S(e,g),Z.M(e,e,g),Z.S(f,e),Z.M(f,f,g),Z.M(f,f,r),Z.pow2523(f,f),Z.M(f,f,e),Z.M(f,f,r),Z.S(M,f),Z.M(M,M,g),Z.Z(a,M,r),Z.A(u,M,r),Z.M(i,r,S),Z.A(i,M,i),t=v(a),n=v(u),o=v(i),Z.M(c,f,S),L(f,c,n|o),D(f,f),t|n}function M(f,r){var g,t=Z.gf(),n=Z.gf(),o=Z.gf(),e=Z.gf(),M=Z.gf(),a=Z.gf(),u=Z.gf(),i=Z.gf(),c=Z.gf(),s=Z.gf(),v=Z.gf(),l=Z.gf(),A=Z.gf(),d=Z.gf();Z.set25519(o,w),Z.S(e,r),Z.M(e,S,e),Z.A(c,e,o),Z.M(c,c,p),Z.set25519(t,w),_(t,t),Z.A(M,e,Z.D),Z.M(s,e,Z.D),Z.Z(s,t,s),Z.M(s,s,M),g=1-U(a,c,s),Z.M(u,a,r),D(u,u),_(u,u),L(a,u,g),L(t,e,g),Z.Z(n,e,o),Z.M(n,n,t),Z.M(n,n,y),Z.Z(n,n,s),Z.A(v,a,a),Z.M(v,v,s),Z.M(l,n,m),Z.S(i,a),Z.Z(A,o,i),Z.A(d,o,i),Z.M(f[0],v,d),Z.M(f[1],A,l),Z.M(f[2],l,d),Z.M(f[3],v,A)}f.ristretto255_from_hash=function(f){var r=Z.gf(),g=Z.gf(),t=[Z.gf(),Z.gf(),Z.gf(),Z.gf()],n=[Z.gf(),Z.gf(),Z.gf(),Z.gf()];return Z.unpack25519(r,f.slice(0,32)),Z.unpack25519(g,f.slice(32,64)),M(t,r),M(n,g),Z.add(t,n),t},f.ristretto255_tobytes=function(f){var r,g=Z.gf(),t=Z.gf(),n=Z.gf(),o=Z.gf(),e=Z.gf(),M=Z.gf(),a=Z.gf(),u=(Z.gf(),Z.gf()),i=Z.gf(),c=Z.gf(),s=Z.gf(),v=Z.gf(),l=Z.gf(),A=Z.gf(),d=Z.gf(),m=Z.gf(),p=Z.gf(),y=new Uint8Array(32);return Z.A(c,f[2],f[1]),Z.Z(p,f[2],f[1]),Z.M(c,c,p),Z.M(s,f[0],f[1]),Z.S(v,s),Z.M(v,c,v),U(e,w,v),Z.M(g,e,c),Z.M(t,e,s),Z.M(m,g,t),Z.M(m,m,f[3]),Z.M(M,f[0],S),Z.M(a,f[1],S),Z.M(o,g,k),Z.M(i,f[3],m),r=F(i),l=Z.gf(f[0]),A=Z.gf(f[1]),n=Z.gf(t),L(l,a,r),L(A,M,r),L(n,o,r),Z.M(d,l,m),h(A,A,F(d)),Z.Z(u,f[2],A),Z.M(u,n,u),D(u,u),Z.pack25519(y,u),y},f.scalarmodL=r,f.invmodL=function(f,r){var g,t,n=new Float64Array(32);for(g=0;g<32;g++)n[g]=r[g];for(g=251;0<=g;g--)e(n,t=n,t),0!=(o[g>>3]>>>(7&g)&1)&&e(n,n,r);for(g=0;g<32;g++)f[g]=n[g]},f.MmodL=e,f.ristretto255_frombytes=function(f,r){var g,t=Z.gf(),n=Z.gf(),o=Z.gf(),e=Z.gf(),M=Z.gf(),a=Z.gf(),u=Z.gf(),i=Z.gf(),c=Z.gf(),s=Z.gf();return 0==function(f){var r,g;for(r=127&f[31]^127,g=30;0<g;g--)r|=255^f[g];return 1-(1&((r=(0|r)-1>>8)&236-(0|f[0])>>8|f[0]))}(r)?-1:(Z.unpack25519(o,r),Z.S(e,o),Z.set25519(M,w),Z.Z(M,M,e),Z.S(u,M),Z.set25519(a,w),Z.A(a,a,e),Z.S(i,a),Z.M(c,Z.D,u),_(c,c),Z.Z(c,c,i),Z.M(s,c,i),Z.set25519(n,w),g=U(t,n,s),Z.M(f[0],t,a),Z.M(f[1],t,f[0]),Z.M(f[1],f[1],c),Z.M(f[0],f[0],o),Z.A(f[0],f[0],f[0]),D(f[0],f[0]),Z.M(f[1],M,f[1]),Z.set25519(f[2],w),Z.M(f[3],f[0],f[1]),-(1-g|F(f[3])|v(f[1])))},f.scalarmodL1=g,f.neg25519=_}("undefined"!=typeof module&&module.exports?module.exports:self.ristretto=self.ristretto||{});
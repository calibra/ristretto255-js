!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(r=r||self).ristretto=n()}(this,function(){"use strict";var f={},M=function(r,n){this.hi=0|r,this.lo=0|n},p=function(r){var n,e=new Float64Array(16);if(r)for(n=0;n<r.length;n++)e[n]=r[n];return e},a=function(){throw new Error("no PRNG")},o=new Uint8Array(16),e=new Uint8Array(32);e[0]=9;var A=p(),b=p([1]),h=p([56129,1]),d=p([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=p([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),t=p([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),i=p([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),U=p([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function g(r,n){return r<<n|r>>>32-n}function s(r,n){var e=255&r[n+3];return(e=(e=e<<8|255&r[n+2])<<8|255&r[n+1])<<8|255&r[n+0]}function x(r,n){var e=r[n]<<24|r[n+1]<<16|r[n+2]<<8|r[n+3],t=r[n+4]<<24|r[n+5]<<16|r[n+6]<<8|r[n+7];return new M(e,t)}function l(r,n,e){var t;for(t=0;t<4;t++)r[n+t]=255&e,e>>>=8}function S(r,n,e){r[n]=e.hi>>24&255,r[n+1]=e.hi>>16&255,r[n+2]=e.hi>>8&255,r[n+3]=255&e.hi,r[n+4]=e.lo>>24&255,r[n+5]=e.lo>>16&255,r[n+6]=e.lo>>8&255,r[n+7]=255&e.lo}function c(r,n,e,t,o){var f,a=0;for(f=0;f<o;f++)a|=r[n+f]^e[t+f];return(1&a-1>>>8)-1}function u(r,n,e,t){return c(r,n,e,t,16)}function E(r,n,e,t){return c(r,n,e,t,32)}function w(r,n,e,t,o){var f,a,i,c=new Uint32Array(16),u=new Uint32Array(16),w=new Uint32Array(16),y=new Uint32Array(4);for(f=0;f<4;f++)u[5*f]=s(t,4*f),u[1+f]=s(e,4*f),u[6+f]=s(n,4*f),u[11+f]=s(e,16+4*f);for(f=0;f<16;f++)w[f]=u[f];for(f=0;f<20;f++){for(a=0;a<4;a++){for(i=0;i<4;i++)y[i]=u[(5*a+4*i)%16];for(y[1]^=g(y[0]+y[3]|0,7),y[2]^=g(y[1]+y[0]|0,9),y[3]^=g(y[2]+y[1]|0,13),y[0]^=g(y[3]+y[2]|0,18),i=0;i<4;i++)c[4*a+(a+i)%4]=y[i]}for(i=0;i<16;i++)u[i]=c[i]}if(o){for(f=0;f<16;f++)u[f]=u[f]+w[f]|0;for(f=0;f<4;f++)u[5*f]=u[5*f]-s(t,4*f)|0,u[6+f]=u[6+f]-s(n,4*f)|0;for(f=0;f<4;f++)l(r,4*f,u[5*f]),l(r,16+4*f,u[6+f])}else for(f=0;f<16;f++)l(r,4*f,u[f]+w[f]|0)}function v(r,n,e,t){return w(r,n,e,t,!1),0}function _(r,n,e,t){return w(r,n,e,t,!0),0}var m=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function B(r,n,e,t,o,f,a){var i,c,u=new Uint8Array(16),w=new Uint8Array(64);if(!o)return 0;for(c=0;c<16;c++)u[c]=0;for(c=0;c<8;c++)u[c]=f[c];for(;64<=o;){for(v(w,u,a,m),c=0;c<64;c++)r[n+c]=(e?e[t+c]:0)^w[c];for(i=1,c=8;c<16;c++)i=i+(255&u[c])|0,u[c]=255&i,i>>>=8;o-=64,n+=64,e&&(t+=64)}if(0<o)for(v(w,u,a,m),c=0;c<o;c++)r[n+c]=(e?e[t+c]:0)^w[c];return 0}function L(r,n,e,t,o){return B(r,n,null,0,e,t,o)}function k(r,n,e,t,o){var f=new Uint8Array(32);return _(f,t,o,m),L(r,n,e,t.subarray(16),f)}function K(r,n,e,t,o,f,a){var i=new Uint8Array(32);return _(i,f,a,m),B(r,n,e,t,o,f.subarray(16),i)}function Y(r,n){var e,t=0;for(e=0;e<17;e++)t=t+(r[e]+n[e]|0)|0,r[e]=255&t,t>>>=8}var T=new Uint32Array([5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,252]);function F(r,n,e,t,o,f){var a,i,c,u,w=new Uint32Array(17),y=new Uint32Array(17),g=new Uint32Array(17),s=new Uint32Array(17),l=new Uint32Array(17);for(c=0;c<17;c++)y[c]=g[c]=0;for(c=0;c<16;c++)y[c]=f[c];for(y[3]&=15,y[4]&=252,y[7]&=15,y[8]&=252,y[11]&=15,y[12]&=252,y[15]&=15;0<o;){for(c=0;c<17;c++)s[c]=0;for(c=0;c<16&&c<o;++c)s[c]=e[t+c];for(s[c]=1,t+=c,o-=c,Y(g,s),i=0;i<17;i++)for(c=w[i]=0;c<17;c++)w[i]=w[i]+g[c]*(c<=i?y[i-c]:320*y[i+17-c]|0)|0;for(i=0;i<17;i++)g[i]=w[i];for(c=u=0;c<16;c++)u=u+g[c]|0,g[c]=255&u,u>>>=8;for(u=u+g[16]|0,g[16]=3&u,u=5*(u>>>2)|0,c=0;c<16;c++)u=u+g[c]|0,g[c]=255&u,u>>>=8;u=u+g[16]|0,g[16]=u}for(c=0;c<17;c++)l[c]=g[c];for(Y(g,T),a=0|-(g[16]>>>7),c=0;c<17;c++)g[c]^=a&(l[c]^g[c]);for(c=0;c<16;c++)s[c]=f[c+16];for(s[16]=0,Y(g,s),c=0;c<16;c++)r[n+c]=g[c];return 0}function Z(r,n,e,t,o,f){var a=new Uint8Array(16);return F(a,0,e,t,o,f),u(r,n,a,0)}function z(r,n,e,t,o){var f;if(e<32)return-1;for(K(r,0,n,0,e,t,o),F(r,16,r,32,e-32,r),f=0;f<16;f++)r[f]=0;return 0}function R(r,n,e,t,o){var f,a=new Uint8Array(32);if(e<32)return-1;if(k(a,0,32,t,o),0!==Z(n,16,n,32,e-32,a))return-1;for(K(r,0,n,0,e,t,o),f=0;f<32;f++)r[f]=0;return 0}function P(r,n){var e;for(e=0;e<16;e++)r[e]=0|n[e]}function N(r){var n,e;for(e=0;e<16;e++)r[e]+=65536,n=Math.floor(r[e]/65536),r[(e+1)*(e<15?1:0)]+=n-1+37*(n-1)*(15===e?1:0),r[e]-=65536*n}function O(r,n,e){for(var t,o=~(e-1),f=0;f<16;f++)t=o&(r[f]^n[f]),r[f]^=t,n[f]^=t}function C(r,n){var e,t,o,f=p(),a=p();for(e=0;e<16;e++)a[e]=n[e];for(N(a),N(a),N(a),t=0;t<2;t++){for(f[0]=a[0]-65517,e=1;e<15;e++)f[e]=a[e]-65535-(f[e-1]>>16&1),f[e-1]&=65535;f[15]=a[15]-32767-(f[14]>>16&1),o=f[15]>>16&1,f[14]&=65535,O(a,f,1-o)}for(e=0;e<16;e++)r[2*e]=255&a[e],r[2*e+1]=a[e]>>8}function I(r,n){var e=new Uint8Array(32),t=new Uint8Array(32);return C(e,r),C(t,n),E(e,0,t,0)}function D(r){var n=new Uint8Array(32);return C(n,r),1&n[0]}function q(r,n){var e;for(e=0;e<16;e++)r[e]=n[2*e]+(n[2*e+1]<<8);r[15]&=32767}function G(r,n,e){var t;for(t=0;t<16;t++)r[t]=n[t]+e[t]|0}function V(r,n,e){var t;for(t=0;t<16;t++)r[t]=n[t]-e[t]|0}function X(r,n,e){var t,o,f=new Float64Array(31);for(t=0;t<31;t++)f[t]=0;for(t=0;t<16;t++)for(o=0;o<16;o++)f[t+o]+=n[t]*e[o];for(t=0;t<15;t++)f[t]+=38*f[t+16];for(t=0;t<16;t++)r[t]=f[t];N(r),N(r)}function j(r,n){X(r,n,n)}function H(r,n){var e,t=p();for(e=0;e<16;e++)t[e]=n[e];for(e=253;0<=e;e--)j(t,t),2!==e&&4!==e&&X(t,t,n);for(e=0;e<16;e++)r[e]=t[e]}function J(r,n){var e,t=p();for(e=0;e<16;e++)t[e]=n[e];for(e=250;0<=e;e--)j(t,t),1!==e&&X(t,t,n);for(e=0;e<16;e++)r[e]=t[e]}function Q(r,n,e){var t,o,f=new Uint8Array(32),a=new Float64Array(80),i=p(),c=p(),u=p(),w=p(),y=p(),g=p();for(o=0;o<31;o++)f[o]=n[o];for(f[31]=127&n[31]|64,f[0]&=248,q(a,e),o=0;o<16;o++)c[o]=a[o],w[o]=i[o]=u[o]=0;for(i[0]=w[0]=1,o=254;0<=o;--o)O(i,c,t=f[o>>>3]>>>(7&o)&1),O(u,w,t),G(y,i,u),V(i,i,u),G(u,c,w),V(c,c,w),j(w,y),j(g,i),X(i,u,i),X(u,c,y),G(y,i,u),V(i,i,u),j(c,i),V(u,w,g),X(i,u,h),G(i,i,w),X(u,u,i),X(i,w,g),X(w,c,a),j(c,y),O(i,c,t),O(u,w,t);for(o=0;o<16;o++)a[o+16]=i[o],a[o+32]=u[o],a[o+48]=c[o],a[o+64]=w[o];var s=a.subarray(32),l=a.subarray(16);return H(s,s),X(l,l,s),C(r,l),0}function W(r,n){return Q(r,n,e)}function $(r,n){return a(n,32),W(r,n)}function rr(r,n,e){var t=new Uint8Array(32);return Q(t,e,n),_(r,o,t,m)}var nr=z,er=R;function tr(){var r,n,e,t=0,o=0,f=0,a=0,i=65535;for(e=0;e<arguments.length;e++)t+=(r=arguments[e].lo)&i,o+=r>>>16,f+=(n=arguments[e].hi)&i,a+=n>>>16;return new M((f+=(o+=t>>>16)>>>16)&i|(a+=f>>>16)<<16,t&i|o<<16)}function or(r,n){return new M(r.hi>>>n,r.lo>>>n|r.hi<<32-n)}function fr(){var r,n=0,e=0;for(r=0;r<arguments.length;r++)n^=arguments[r].lo,e^=arguments[r].hi;return new M(e,n)}function ar(r,n){var e,t,o=32-n;return n<32?(e=r.hi>>>n|r.lo<<o,t=r.lo>>>n|r.hi<<o):n<64&&(e=r.lo>>>n|r.hi<<o,t=r.hi>>>n|r.lo<<o),new M(e,t)}var ir=[new M(1116352408,3609767458),new M(1899447441,602891725),new M(3049323471,3964484399),new M(3921009573,2173295548),new M(961987163,4081628472),new M(1508970993,3053834265),new M(2453635748,2937671579),new M(2870763221,3664609560),new M(3624381080,2734883394),new M(310598401,1164996542),new M(607225278,1323610764),new M(1426881987,3590304994),new M(1925078388,4068182383),new M(2162078206,991336113),new M(2614888103,633803317),new M(3248222580,3479774868),new M(3835390401,2666613458),new M(4022224774,944711139),new M(264347078,2341262773),new M(604807628,2007800933),new M(770255983,1495990901),new M(1249150122,1856431235),new M(1555081692,3175218132),new M(1996064986,2198950837),new M(2554220882,3999719339),new M(2821834349,766784016),new M(2952996808,2566594879),new M(3210313671,3203337956),new M(3336571891,1034457026),new M(3584528711,2466948901),new M(113926993,3758326383),new M(338241895,168717936),new M(666307205,1188179964),new M(773529912,1546045734),new M(1294757372,1522805485),new M(1396182291,2643833823),new M(1695183700,2343527390),new M(1986661051,1014477480),new M(2177026350,1206759142),new M(2456956037,344077627),new M(2730485921,1290863460),new M(2820302411,3158454273),new M(3259730800,3505952657),new M(3345764771,106217008),new M(3516065817,3606008344),new M(3600352804,1432725776),new M(4094571909,1467031594),new M(275423344,851169720),new M(430227734,3100823752),new M(506948616,1363258195),new M(659060556,3750685593),new M(883997877,3785050280),new M(958139571,3318307427),new M(1322822218,3812723403),new M(1537002063,2003034995),new M(1747873779,3602036899),new M(1955562222,1575990012),new M(2024104815,1125592928),new M(2227730452,2716904306),new M(2361852424,442776044),new M(2428436474,593698344),new M(2756734187,3733110249),new M(3204031479,2999351573),new M(3329325298,3815920427),new M(3391569614,3928383900),new M(3515267271,566280711),new M(3940187606,3454069534),new M(4118630271,4000239992),new M(116418474,1914138554),new M(174292421,2731055270),new M(289380356,3203993006),new M(460393269,320620315),new M(685471733,587496836),new M(852142971,1086792851),new M(1017036298,365543100),new M(1126000580,2618297676),new M(1288033470,3409855158),new M(1501505948,4234509866),new M(1607167915,987167468),new M(1816402316,1246189591)];function cr(r,n,e){var t,o,f,a=[],i=[],c=[],u=[];for(o=0;o<8;o++)a[o]=c[o]=x(r,8*o);for(var w,y,g,s,l,h,v,_,p,A,b,d,U,E,m=0;128<=e;){for(o=0;o<16;o++)u[o]=x(n,8*o+m);for(o=0;o<80;o++){for(f=0;f<8;f++)i[f]=c[f];for(t=tr(c[7],fr(ar(E=c[4],14),ar(E,18),ar(E,41)),(p=c[4],A=c[5],b=c[6],void 0,d=p.hi&A.hi^~p.hi&b.hi,U=p.lo&A.lo^~p.lo&b.lo,new M(d,U)),ir[o],u[o%16]),i[7]=tr(t,fr(ar(_=c[0],28),ar(_,34),ar(_,39)),(g=c[0],s=c[1],l=c[2],void 0,h=g.hi&s.hi^g.hi&l.hi^s.hi&l.hi,v=g.lo&s.lo^g.lo&l.lo^s.lo&l.lo,new M(h,v))),i[3]=tr(i[3],t),f=0;f<8;f++)c[(f+1)%8]=i[f];if(o%16==15)for(f=0;f<16;f++)u[f]=tr(u[f],u[(f+9)%16],fr(ar(y=u[(f+1)%16],1),ar(y,8),or(y,7)),fr(ar(w=u[(f+14)%16],19),ar(w,61),or(w,6)))}for(o=0;o<8;o++)c[o]=tr(c[o],a[o]),a[o]=c[o];m+=128,e-=128}for(o=0;o<8;o++)S(r,8*o,a[o]);return e}var ur=new Uint8Array([106,9,230,103,243,188,201,8,187,103,174,133,132,202,167,59,60,110,243,114,254,148,248,43,165,79,245,58,95,29,54,241,81,14,82,127,173,230,130,209,155,5,104,140,43,62,108,31,31,131,217,171,251,65,189,107,91,224,205,25,19,126,33,121]);function wr(r,n,e){var t,o=new Uint8Array(64),f=new Uint8Array(256),a=e;for(t=0;t<64;t++)o[t]=ur[t];for(cr(o,n,e),e%=128,t=0;t<256;t++)f[t]=0;for(t=0;t<e;t++)f[t]=n[a-e+t];for(f[e]=128,f[(e=256-128*(e<112?1:0))-9]=0,S(f,e-8,new M(a/536870912|0,a<<3)),cr(o,f,e),t=0;t<64;t++)r[t]=o[t];return 0}function yr(r,n){var e=p(),t=p(),o=p(),f=p(),a=p(),i=p(),c=p(),u=p(),w=p();V(e,r[1],r[0]),V(w,n[1],n[0]),X(e,e,w),G(t,r[0],r[1]),G(w,n[0],n[1]),X(t,t,w),X(o,r[3],n[3]),X(o,o,y),X(f,r[2],n[2]),G(f,f,f),V(a,t,e),V(i,f,o),G(c,f,o),G(u,t,e),X(r[0],a,i),X(r[1],u,c),X(r[2],c,i),X(r[3],a,u)}function gr(r,n,e){var t;for(t=0;t<4;t++)O(r[t],n[t],e)}function sr(r,n){var e=p(),t=p(),o=p();H(o,n[2]),X(e,n[0],o),X(t,n[1],o),C(r,t),r[31]^=D(e)<<7}function lr(r,n,e){var t,o;for(P(r[0],A),P(r[1],b),P(r[2],b),P(r[3],A),o=255;0<=o;--o)gr(r,n,t=e[o/8|0]>>(7&o)&1),yr(n,r),yr(r,r),gr(r,n,t)}function hr(r,n){var e=[p(),p(),p(),p()];P(e[0],t),P(e[1],i),P(e[2],b),X(e[3],t,i),lr(r,e,n)}function vr(r,n,e){var t,o=new Uint8Array(64),f=[p(),p(),p(),p()];for(e||a(n,32),wr(o,n,32),o[0]&=248,o[31]&=127,o[31]|=64,hr(f,o),sr(r,f),t=0;t<32;t++)n[t+32]=r[t];return 0}var _r=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function pr(r,n){var e,t,o,f;for(t=63;32<=t;--t){for(e=0,o=t-32,f=t-12;o<f;++o)n[o]+=e-16*n[t]*_r[o-(t-32)],e=n[o]+128>>8,n[o]-=256*e;n[o]+=e,n[t]=0}for(o=e=0;o<32;o++)n[o]+=e-(n[31]>>4)*_r[o],e=n[o]>>8,n[o]&=255;for(o=0;o<32;o++)n[o]-=e*_r[o];for(t=0;t<32;t++)n[t+1]+=n[t]>>8,r[t]=255&n[t]}function Ar(r){var n,e=new Float64Array(64);for(n=0;n<64;n++)e[n]=r[n];for(n=0;n<64;n++)r[n]=0;pr(r,e)}function br(r,n,e,t){var o,f,a=new Uint8Array(64),i=new Uint8Array(64),c=new Uint8Array(64),u=new Float64Array(64),w=[p(),p(),p(),p()];wr(a,t,32),a[0]&=248,a[31]&=127,a[31]|=64;var y=e+64;for(o=0;o<e;o++)r[64+o]=n[o];for(o=0;o<32;o++)r[32+o]=a[32+o];for(wr(c,r.subarray(32),e+32),Ar(c),hr(w,c),sr(r,w),o=32;o<64;o++)r[o]=t[o];for(wr(i,r,e+64),Ar(i),o=0;o<64;o++)u[o]=0;for(o=0;o<32;o++)u[o]=c[o];for(o=0;o<32;o++)for(f=0;f<32;f++)u[o+f]+=i[o]*a[f];return pr(r.subarray(32),u),y}function dr(r,n,e,t){var o,f,a,i,c,u,w,y,g,s,l=new Uint8Array(32),h=new Uint8Array(64),v=[p(),p(),p(),p()],_=[p(),p(),p(),p()];if(e<64)return-1;if(f=_,a=t,i=p(),c=p(),u=p(),w=p(),y=p(),g=p(),s=p(),P(f[2],b),q(f[1],a),j(u,f[1]),X(w,u,d),V(u,u,f[2]),G(w,f[2],w),j(y,w),j(g,y),X(s,g,y),X(i,s,u),X(i,i,w),J(i,i),X(i,i,u),X(i,i,w),X(i,i,w),X(f[0],i,w),j(c,f[0]),X(c,c,w),I(c,u)&&X(f[0],f[0],U),j(c,f[0]),X(c,c,w),I(c,u)?-1:(D(f[0])===a[31]>>7&&V(f[0],A,f[0]),X(f[3],f[0],f[1]),0))return-1;for(o=0;o<e;o++)r[o]=n[o];for(o=0;o<32;o++)r[o+32]=t[o];if(wr(h,r,e),Ar(h),lr(v,_,h),hr(_,n.subarray(32)),yr(v,_),sr(l,v),e-=64,E(n,0,l,0)){for(o=0;o<e;o++)r[o]=0;return-1}for(o=0;o<e;o++)r[o]=n[o+64];return e}function Ur(r,n){if(32!==r.length)throw new Error("bad key size");if(24!==n.length)throw new Error("bad nonce size")}function Er(){for(var r=0;r<arguments.length;r++)if(!(arguments[r]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function mr(r){for(var n=0;n<r.length;n++)r[n]=0}f.lowlevel={crypto_core_hsalsa20:_,crypto_stream_xor:K,crypto_stream:k,crypto_stream_salsa20_xor:B,crypto_stream_salsa20:L,crypto_onetimeauth:F,crypto_onetimeauth_verify:Z,crypto_verify_16:u,crypto_verify_32:E,crypto_secretbox:z,crypto_secretbox_open:R,crypto_scalarmult:Q,crypto_scalarmult_base:W,crypto_box_beforenm:rr,crypto_box_afternm:nr,crypto_box:function(r,n,e,t,o,f){var a=new Uint8Array(32);return rr(a,o,f),nr(r,n,e,t,a)},crypto_box_open:function(r,n,e,t,o,f){var a=new Uint8Array(32);return rr(a,o,f),er(r,n,e,t,a)},crypto_box_keypair:$,crypto_hash:wr,crypto_sign:br,crypto_sign_keypair:vr,crypto_sign_open:dr,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:64,crypto_sign_PUBLICKEYBYTES:32,crypto_sign_SECRETKEYBYTES:64,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:p,D:d,L:_r,pack25519:C,unpack25519:q,M:X,A:G,S:j,Z:V,pow2523:J,add:yr,set25519:P,modL:pr,scalarmult:lr,scalarbase:hr,randombytes:a},f.randomBytes=function(r){var n=new Uint8Array(r);return a(n,r),n},f.secretbox=function(r,n,e){Er(r,n,e),Ur(e,n);for(var t=new Uint8Array(32+r.length),o=new Uint8Array(t.length),f=0;f<r.length;f++)t[f+32]=r[f];return z(o,t,t.length,n,e),o.subarray(16)},f.secretbox.open=function(r,n,e){Er(r,n,e),Ur(e,n);for(var t=new Uint8Array(16+r.length),o=new Uint8Array(t.length),f=0;f<r.length;f++)t[f+16]=r[f];return t.length<32?null:0!==R(o,t,t.length,n,e)?null:o.subarray(32)},f.secretbox.keyLength=32,f.secretbox.nonceLength=24,f.secretbox.overheadLength=16,f.scalarMult=function(r,n){if(Er(r,n),32!==r.length)throw new Error("bad n size");if(32!==n.length)throw new Error("bad p size");var e=new Uint8Array(32);return Q(e,r,n),e},f.scalarMult.base=function(r){if(Er(r),32!==r.length)throw new Error("bad n size");var n=new Uint8Array(32);return W(n,r),n},f.scalarMult.scalarLength=32,f.scalarMult.groupElementLength=32,f.box=function(r,n,e,t){var o=f.box.before(e,t);return f.secretbox(r,n,o)},f.box.before=function(r,n){Er(r,n),function(r,n){if(32!==r.length)throw new Error("bad public key size");if(32!==n.length)throw new Error("bad secret key size")}(r,n);var e=new Uint8Array(32);return rr(e,r,n),e},f.box.after=f.secretbox,f.box.open=function(r,n,e,t){var o=f.box.before(e,t);return f.secretbox.open(r,n,o)},f.box.open.after=f.secretbox.open,f.box.keyPair=function(){var r=new Uint8Array(32),n=new Uint8Array(32);return $(r,n),{publicKey:r,secretKey:n}},f.box.keyPair.fromSecretKey=function(r){if(Er(r),32!==r.length)throw new Error("bad secret key size");var n=new Uint8Array(32);return W(n,r),{publicKey:n,secretKey:new Uint8Array(r)}},f.box.publicKeyLength=32,f.box.secretKeyLength=32,f.box.sharedKeyLength=32,f.box.nonceLength=24,f.box.overheadLength=f.secretbox.overheadLength,f.sign=function(r,n){if(Er(r,n),64!==n.length)throw new Error("bad secret key size");var e=new Uint8Array(64+r.length);return br(e,r,r.length,n),e},f.sign.open=function(r,n){if(Er(r,n),32!==n.length)throw new Error("bad public key size");var e=new Uint8Array(r.length),t=dr(e,r,r.length,n);if(t<0)return null;for(var o=new Uint8Array(t),f=0;f<o.length;f++)o[f]=e[f];return o},f.sign.detached=function(r,n){for(var e=f.sign(r,n),t=new Uint8Array(64),o=0;o<t.length;o++)t[o]=e[o];return t},f.sign.detached.verify=function(r,n,e){if(Er(r,n,e),64!==n.length)throw new Error("bad signature size");if(32!==e.length)throw new Error("bad public key size");var t,o=new Uint8Array(64+r.length),f=new Uint8Array(64+r.length);for(t=0;t<64;t++)o[t]=n[t];for(t=0;t<r.length;t++)o[t+64]=r[t];return 0<=dr(f,o,o.length,e)},f.sign.keyPair=function(){var r=new Uint8Array(32),n=new Uint8Array(64);return vr(r,n),{publicKey:r,secretKey:n}},f.sign.keyPair.fromSecretKey=function(r){if(Er(r),64!==r.length)throw new Error("bad secret key size");for(var n=new Uint8Array(32),e=0;e<n.length;e++)n[e]=r[32+e];return{publicKey:n,secretKey:new Uint8Array(r)}},f.sign.keyPair.fromSeed=function(r){if(Er(r),32!==r.length)throw new Error("bad seed size");for(var n=new Uint8Array(32),e=new Uint8Array(64),t=0;t<32;t++)e[t]=r[t];return vr(n,e,!0),{publicKey:n,secretKey:e}},f.sign.publicKeyLength=32,f.sign.secretKeyLength=64,f.sign.seedLength=32,f.sign.signatureLength=64,f.hash=function(r){Er(r);var n=new Uint8Array(64);return wr(n,r,r.length),n},f.hash.hashLength=64,f.verify=function(r,n){return Er(r,n),0!==r.length&&0!==n.length&&(r.length===n.length&&0===c(r,0,n,0,r.length))},f.setPRNG=function(r){a=r},function(){var o="undefined"!=typeof self?self.crypto||self.msCrypto:null;if(o&&o.getRandomValues){f.setPRNG(function(r,n){var e,t=new Uint8Array(n);for(e=0;e<n;e+=65536)o.getRandomValues(t.subarray(e,e+Math.min(n-e,65536)));for(e=0;e<n;e++)r[e]=t[e];mr(t)})}else"undefined"!=typeof require&&(o=require("crypto"))&&o.randomBytes&&f.setPRNG(function(r,n){var e,t=o.randomBytes(n);for(e=0;e<n;e++)r[e]=t[e];mr(t)})}(),"undefined"!=typeof require?require("crypto"):window.crypto;var r={},Mr=f.lowlevel,xr=Mr.gf([1]),Sr=new Float64Array([235,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Br(r,n,e){var t,o,f=new Float64Array(64);for(t=0;t<64;t++)f[t]=0;for(t=0;t<32;t++)for(o=0;o<32;o++)f[t+o]+=n[t]*e[o];Mr.modL(r,f)}var Lr=Mr.gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]),kr=Mr.gf([11803,18811,63136,32407,21693,7032,36364,44957,53757,12789,64713,3900,18604,11139,12735,14185]),Kr=Mr.gf([16618,32861,64938,39368,29374,23105,5655,40239,55360,65025,31633,5826,64674,53167,35077,30828]),Yr=Mr.gf([49526,37983,2497,57980,13583,52574,41272,11393,57316,48752,43997,39316,57559,45747,29352,656]),Tr=Mr.gf([19744,17645,23210,12717,6553,45086,18988,53918,20203,21147,54063,19676,8769,63084,45946,22888]);function Fr(r){var n=new Uint8Array(32);Mr.pack25519(n,r);for(var e=1,t=0;t<32;t++)e&=0==n[t];return e}function Zr(r,n,e){for(var t,o=-e,f=0;f<16;f++)t=r[f]^n[f],t&=o,r[f]^=t}function zr(r){var n=new Uint8Array(32);return Mr.pack25519(n,r),1&n[0]}function Rr(r,n){Mr.Z(r,Mr.gf(),n)}function Pr(r,n,e){var t=Mr.gf();Rr(t,n),Mr.set25519(r,n),Zr(r,t,e)}function Nr(r,n){Pr(r,n,zr(n))}function Or(r,n,e){var t,o,f,a=Mr.gf(),i=Mr.gf(),c=Mr.gf(),u=Mr.gf(),w=Mr.gf(),y=Mr.gf();return Mr.S(a,e),Mr.M(a,a,e),Mr.S(r,a),Mr.M(r,r,e),Mr.M(r,r,n),Mr.pow2523(r,r),Mr.M(r,r,a),Mr.M(r,r,n),Mr.S(i,r),Mr.M(i,i,e),Mr.Z(c,i,n),Mr.A(u,i,n),Mr.M(w,n,Lr),Mr.A(w,i,w),t=Fr(c),o=Fr(u),f=Fr(w),Mr.M(y,r,Lr),Zr(r,y,o|f),Nr(r,r),t|o}function Cr(r){var n,e=Mr.gf(),t=Mr.gf(),o=Mr.gf(),f=Mr.gf(),a=Mr.gf(),i=Mr.gf(),c=Mr.gf(),u=(Mr.gf(),Mr.gf()),w=Mr.gf(),y=Mr.gf(),g=Mr.gf(),s=Mr.gf(),l=Mr.gf(),h=Mr.gf(),v=Mr.gf(),_=Mr.gf(),p=Mr.gf(),A=new Uint8Array(32);return Mr.A(y,r[2],r[1]),Mr.Z(p,r[2],r[1]),Mr.M(y,y,p),Mr.M(g,r[0],r[1]),Mr.S(s,g),Mr.M(s,y,s),Or(a,xr,s),Mr.M(e,a,y),Mr.M(t,a,g),Mr.M(_,e,t),Mr.M(_,_,r[3]),Mr.M(i,r[0],Lr),Mr.M(c,r[1],Lr),Mr.M(f,e,Kr),Mr.M(w,r[3],_),n=zr(w),l=Mr.gf(r[0]),h=Mr.gf(r[1]),o=Mr.gf(t),Zr(l,c,n),Zr(h,i,n),Zr(o,f,n),Mr.M(v,l,_),Pr(h,h,zr(v)),Mr.Z(u,r[2],h),Mr.M(u,o,u),Nr(u,u),Mr.pack25519(A,u),A}function Ir(r,n){var e,t=Mr.gf(),o=Mr.gf(),f=Mr.gf(),a=Mr.gf(),i=Mr.gf(),c=Mr.gf(),u=Mr.gf(),w=Mr.gf(),y=Mr.gf(),g=Mr.gf();return 0==function(r){var n,e;for(n=127&r[31]^127,e=30;0<e;e--)n|=255^r[e];return 1-(1&((n=(0|n)-1>>8)&236-(0|r[0])>>8|r[0]))}(n)?-1:(Mr.unpack25519(f,n),Mr.S(a,f),Mr.set25519(i,xr),Mr.Z(i,i,a),Mr.S(u,i),Mr.set25519(c,xr),Mr.A(c,c,a),Mr.S(w,c),Mr.M(y,Mr.D,u),Rr(y,y),Mr.Z(y,y,w),Mr.M(g,y,w),Mr.set25519(o,xr),e=Or(t,o,g),Mr.M(r[0],t,c),Mr.M(r[1],t,r[0]),Mr.M(r[1],r[1],y),Mr.M(r[0],r[0],f),Mr.A(r[0],r[0],r[0]),Nr(r[0],r[0]),Mr.M(r[1],i,r[1]),Mr.set25519(r[2],xr),Mr.M(r[3],r[0],r[1]),-(1-e|zr(r[3])|Fr(r[1])))}function Dr(r,n){var e,t=Mr.gf(),o=Mr.gf(),f=Mr.gf(),a=Mr.gf(),i=Mr.gf(),c=Mr.gf(),u=Mr.gf(),w=Mr.gf(),y=Mr.gf(),g=Mr.gf(),s=Mr.gf(),l=Mr.gf(),h=Mr.gf(),v=Mr.gf();Mr.set25519(f,xr),Mr.S(a,n),Mr.M(a,Lr,a),Mr.A(y,a,f),Mr.M(y,y,Yr),Mr.set25519(t,xr),Rr(t,t),Mr.A(i,a,Mr.D),Mr.M(g,a,Mr.D),Mr.Z(g,t,g),Mr.M(g,g,i),e=1-Or(c,y,g),Mr.M(u,c,n),Nr(u,u),Rr(u,u),Zr(c,u,e),Zr(t,a,e),Mr.Z(o,a,f),Mr.M(o,o,t),Mr.M(o,o,Tr),Mr.Z(o,o,g),Mr.A(s,c,c),Mr.M(s,s,g),Mr.M(l,o,kr),Mr.S(w,c),Mr.Z(h,f,w),Mr.A(v,f,w),Mr.M(r[0],s,v),Mr.M(r[1],h,l),Mr.M(r[2],l,v),Mr.M(r[3],s,h)}function n(r){var n=Mr.gf(),e=Mr.gf(),t=[Mr.gf(),Mr.gf(),Mr.gf(),Mr.gf()],o=[Mr.gf(),Mr.gf(),Mr.gf(),Mr.gf()];return Mr.unpack25519(n,r.slice(0,32)),Mr.unpack25519(e,r.slice(32,64)),Dr(t,n),Dr(o,e),Mr.add(t,o),t}function qr(r,n){var e=Mr.gf();Rr(e,n[3]);var t=Mr.gf();Rr(t,n[0]);var o=[t,n[1],n[2],e];Mr.add(r,o)}function Gr(){return n(f.randomBytes(64))}function Vr(r){var n,e=new Float64Array(64);for(n=0;n<32;n++)e[n]=r[n];Mr.modL(r,e)}function Xr(r){var n,e=new Float64Array(32);for(n=0;n<32;n++)e[n]=-r[n];return Vr(e),e}function jr(r,n){var e,t=new Float64Array(32);for(e=0;e<32;e++)t[e]=r[e]+n[e];return Vr(t),t}return r.crypto_scalarmult_ristretto255_base=function(r){var n=[Mr.gf(),Mr.gf(),Mr.gf(),Mr.gf()];return Mr.scalarbase(n,r),Cr(n)},r.crypto_scalarmult_ristretto255=function(r,n){var e=[Mr.gf(),Mr.gf(),Mr.gf(),Mr.gf()],t=[Mr.gf(),Mr.gf(),Mr.gf(),Mr.gf()];if(0!=Ir(t,n))throw"Invalid argument";return Mr.scalarmult(e,t,r),Cr(e)},r.crypto_core_ristretto255_is_valid_point=function(r){return-1==Ir([Mr.gf(),Mr.gf(),Mr.gf(),Mr.gf()],r)?0:1},r.crypto_core_ristretto255_add=function(r,n){var e=[Mr.gf(),Mr.gf(),Mr.gf(),Mr.gf()],t=[Mr.gf(),Mr.gf(),Mr.gf(),Mr.gf()];if(-1==Ir(e,r))throw"Invalid argument";if(-1==Ir(t,n))throw"Invalid argument";var o=[e[0],e[1],e[2],e[3]];return Mr.add(o,t),Cr(o)},r.crypto_core_ristretto255_sub=function(r,n){var e=[Mr.gf(),Mr.gf(),Mr.gf(),Mr.gf()],t=[Mr.gf(),Mr.gf(),Mr.gf(),Mr.gf()];if(-1==Ir(e,r))throw"Invalid argument";if(-1==Ir(t,n))throw"Invalid argument";var o=[e[0],e[1],e[2],e[3]];return qr(o,t),Cr(o)},r.crypto_core_ristretto255_from_hash=function(r){return Cr(n(r))},r.crypto_core_ristretto255_random=function(){return Cr(Gr())},r.crypto_core_ristretto255_scalar_random=function(){var r=new Uint8Array(32);do{(r=f.randomBytes(32))[31]&=31;for(var n=32,e=1,t=0;t|=r[--n]-Mr.L[n]>>8&e,e&=(r[n]^Mr.L[n])-1>>8,0!=n;);}while(0==t);var o=new Float64Array(32);for(n=0;n<32;n++)o[n]=r[n];return o},r.crypto_core_ristretto255_scalar_invert=function(r){var n=new Float64Array(32);return function(r,n){var e,t,o=new Float64Array(32);for(e=0;e<32;e++)o[e]=n[e];for(e=251;0<=e;e--)Br(o,t=o,t),0!=(Sr[e>>3]>>>(7&e)&1)&&Br(o,o,n);for(e=0;e<32;e++)r[e]=o[e]}(n,r),n},r.crypto_core_ristretto255_scalar_negate=Xr,r.crypto_core_ristretto255_scalar_add=jr,r.crypto_core_ristretto255_scalar_sub=function(r,n){return jr(r,Xr(n))},r.crypto_core_ristretto255_scalar_mul=function(r,n){var e=new Float64Array(32);return Br(e,r,n),e},r.ristretto255_from_hash=n,r.ristretto255_tobytes=Cr,r.ristretto255_frombytes=Ir,r.sub=qr,r.ristretto255_random=Gr,r.nacl_add=Mr.add,r.nacl_scalarbase=Mr.scalarbase,r.nacl_scalarmult=Mr.scalarmult,r.nacl_gf=Mr.gf,r});

!function(r){"use strict";var a=require("crypto"),A=require("./nacl").lowlevel,w=A.gf([1]),g=new Float64Array([235,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function e(r,t,f){var o,n,a=new Float64Array(64);for(o=0;o<64;o++)a[o]=0;for(o=0;o<32;o++)for(n=0;n<32;n++)a[o+n]+=t[o]*f[n];var g=0;for(n=0;n<64;n++)a[n]+=g,g=a[n]>>8,a[n]&=255;A.modL(r,a)}var F=A.gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]),d=A.gf([11803,18811,63136,32407,21693,7032,36364,44957,53757,12789,64713,3900,18604,11139,12735,14185]),h=A.gf([16618,32861,64938,39368,29374,23105,5655,40239,55360,65025,31633,5826,64674,53167,35077,30828]),p=A.gf([49526,37983,2497,57980,13583,52574,41272,11393,57316,48752,43997,39316,57559,45747,29352,656]),m=A.gf([19744,17645,23210,12717,6553,45086,18988,53918,20203,21147,54063,19676,8769,63084,45946,22888]);function l(r){var t=new Uint8Array(32);A.pack25519(t,r);for(var f=1,o=0;o<32;o++)f&=0==t[o];return f}function Z(r,t,f){for(var o,n=-f,a=0;a<16;a++)o=r[a]^t[a],o&=n,r[a]^=o}function S(r){var t=new Uint8Array(32);return A.pack25519(t,r),1&t[0]}function b(r,t){A.Z(r,A.gf(),t)}function k(r,t,f){var o=A.gf();b(o,t),A.set25519(r,t),Z(r,o,f)}function L(r,t){k(r,t,S(t))}function I(r,t,f){var o,n,a,g=A.gf(),e=A.gf(),c=A.gf(),i=A.gf(),u=A.gf(),s=A.gf();return A.S(g,f),A.M(g,g,f),A.S(r,g),A.M(r,r,f),A.M(r,r,t),A.pow2523(r,r),A.M(r,r,g),A.M(r,r,t),A.S(e,r),A.M(e,e,f),A.Z(c,e,t),A.A(i,e,t),A.M(u,t,F),A.A(u,e,u),o=l(c),n=l(i),a=l(u),A.M(s,r,F),Z(r,s,n|a),L(r,r),o|n}function c(r){var t,f=A.gf(),o=A.gf(),n=A.gf(),a=A.gf(),g=A.gf(),e=A.gf(),c=A.gf(),i=(A.gf(),A.gf()),u=A.gf(),s=A.gf(),_=A.gf(),l=A.gf(),M=A.gf(),v=A.gf(),y=A.gf(),d=A.gf(),p=A.gf(),m=new Uint8Array(32);return A.A(s,r[2],r[1]),A.Z(p,r[2],r[1]),A.M(s,s,p),A.M(_,r[0],r[1]),A.S(l,_),A.M(l,s,l),I(g,w,l),A.M(f,g,s),A.M(o,g,_),A.M(d,f,o),A.M(d,d,r[3]),A.M(e,r[0],F),A.M(c,r[1],F),A.M(a,f,h),A.M(u,r[3],d),t=S(u),M=A.gf(r[0]),v=A.gf(r[1]),n=A.gf(o),Z(M,c,t),Z(v,e,t),Z(n,a,t),A.M(y,M,d),k(v,v,S(y)),A.Z(i,r[2],v),A.M(i,n,i),L(i,i),A.pack25519(m,i),m}function i(r,t){var f,o=A.gf(),n=A.gf(),a=A.gf(),g=A.gf(),e=A.gf(),c=A.gf(),i=A.gf(),u=A.gf(),s=A.gf(),_=A.gf();return 0==function(r){var t,f;for(t=127&r[31]^127,f=30;0<f;f--)t|=255^r[f];return 1-(1&((t=(0|t)-1>>8)&236-(0|r[0])>>8|r[0]))}(t)?-1:(A.unpack25519(a,t),A.S(g,a),A.set25519(e,w),A.Z(e,e,g),A.S(i,e),A.set25519(c,w),A.A(c,c,g),A.S(u,c),A.M(s,A.D,i),b(s,s),A.Z(s,s,u),A.M(_,s,u),A.set25519(n,w),f=I(o,n,_),A.M(r[0],o,c),A.M(r[1],o,r[0]),A.M(r[1],r[1],s),A.M(r[0],r[0],a),A.A(r[0],r[0],r[0]),L(r[0],r[0]),A.M(r[1],e,r[1]),A.set25519(r[2],w),A.M(r[3],r[0],r[1]),-(1-f|S(r[3])|l(r[1])))}function u(r,t){var f,o=A.gf(),n=A.gf(),a=A.gf(),g=A.gf(),e=A.gf(),c=A.gf(),i=A.gf(),u=A.gf(),s=A.gf(),_=A.gf(),l=A.gf(),M=A.gf(),v=A.gf(),y=A.gf();A.set25519(a,w),A.S(g,t),A.M(g,F,g),A.A(s,g,a),A.M(s,s,p),A.set25519(o,w),b(o,o),A.A(e,g,A.D),A.M(_,g,A.D),A.Z(_,o,_),A.M(_,_,e),f=1-I(c,s,_),A.M(i,c,t),L(i,i),b(i,i),Z(c,i,f),Z(o,g,f),A.Z(n,g,a),A.M(n,n,o),A.M(n,n,m),A.Z(n,n,_),A.A(l,c,c),A.M(l,l,_),A.M(M,n,d),A.S(u,c),A.Z(v,a,u),A.A(y,a,u),A.M(r[0],l,y),A.M(r[1],v,M),A.M(r[2],M,y),A.M(r[3],l,v)}function t(r){var t=A.gf(),f=A.gf(),o=[A.gf(),A.gf(),A.gf(),A.gf()],n=[A.gf(),A.gf(),A.gf(),A.gf()];return A.unpack25519(t,r.slice(0,32)),A.unpack25519(f,r.slice(32,64)),u(o,t),u(n,f),A.add(o,n),o}function s(r,t){var f=A.gf();b(f,t[3]);var o=A.gf();b(o,t[0]);var n=[o,t[1],t[2],f];A.add(r,n)}function f(){return t(a.randomBytes(64))}r.crypto_scalarmult_ristretto255_base=function(r){var t=[A.gf(),A.gf(),A.gf(),A.gf()];return A.scalarbase(t,r),c(t)},r.crypto_scalarmult_ristretto255=function(r,t){var f=[A.gf(),A.gf(),A.gf(),A.gf()],o=[A.gf(),A.gf(),A.gf(),A.gf()];if(0!=i(o,t))throw"Invalid argument";return A.scalarmult(f,o,r),c(f)},r.crypto_core_ristretto255_is_valid_point=function(r){return-1==i([A.gf(),A.gf(),A.gf(),A.gf()],r)?0:1},r.crypto_core_ristretto255_add=function(r,t){var f=[A.gf(),A.gf(),A.gf(),A.gf()],o=[A.gf(),A.gf(),A.gf(),A.gf()];if(-1==i(f,r))throw"Invalid argument";if(-1==i(o,t))throw"Invalid argument";var n=[f[0],f[1],f[2],f[3]];return A.add(n,o),c(n)},r.crypto_core_ristretto255_sub=function(r,t){var f=[A.gf(),A.gf(),A.gf(),A.gf()],o=[A.gf(),A.gf(),A.gf(),A.gf()];if(-1==i(f,r))throw"Invalid argument";if(-1==i(o,t))throw"Invalid argument";var n=[f[0],f[1],f[2],f[3]];return s(n,o),c(n)},r.crypto_core_ristretto255_from_hash=function(r){return c(t(r))},r.crypto_core_ristretto255_random=function(){return c(f())},r.crypto_core_ristretto255_scalar_random=function(){var r;do{(r=a.randomBytes(32))[31]&=31;for(var t=32,f=1,o=0;o|=r[--t]-A.L[t]>>8&f,f&=(r[t]^A.L[t])-1>>8,0!=t;);}while(0==o);var n=new Float64Array(32);for(t=0;t<32;t++)n[t]=r[t];return n},r.crypto_core_ristretto255_scalar_invert=function(r){var t=new Float64Array(32);return function(r,t){var f,o,n=new Float64Array(32);for(f=0;f<32;f++)n[f]=t[f];for(f=251;0<=f;f--)e(n,o=n,o),0!=(g[f>>3]>>>(7&f)&1)&&e(n,n,t);for(f=0;f<32;f++)r[f]=n[f]}(t,r),t},r.crypto_core_ristretto255_scalar_negate=function(r){var t,f=new Float64Array(32),o=new Float64Array(32);for(t=0;t<32;t++)f[t]=-r[t];return A.modL(o,f),o},r.crypto_core_ristretto255_scalar_add=function(r,t){var f,o=new Float64Array(32),n=new Float64Array(32);for(f=0;f<32;f++)o[f]=r[f]+t[f];return A.modL(n,o),n},r.crypto_core_ristretto255_scalar_sub=function(r,t){var f,o=new Float64Array(32),n=new Float64Array(32);for(f=0;f<32;f++)o[f]=r[f]-t[f];return A.modL(n,o),n},r.crypto_core_ristretto255_scalar_mul=function(r,t){var f=new Float64Array(32);return e(f,r,t),f},r.ristretto255_from_hash=t,r.ristretto255_tobytes=c,r.ristretto255_frombytes=i,r.sub=s,r.ristretto255_random=f}("undefined"!=typeof module&&module.exports?module.exports:self.ristretto=self.ristretto||{});
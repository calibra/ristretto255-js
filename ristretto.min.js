!function(f,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("tweetnacl")):"function"==typeof define&&define.amd?define(["tweetnacl"],r):(f=f||self).ristretto=r(f.nacl)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,"undefined"!=typeof require?require("crypto"):window.crypto||window.msCrypto;var f={},p=e.lowlevel,A=p.gf([1]),g=new Float64Array([235,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function o(f,r,n){var a,t,g=new Float64Array(64);for(a=0;a<64;a++)g[a]=0;for(a=0;a<32;a++)for(t=0;t<32;t++)g[a+t]+=r[a]*n[t];p.modL(f,g)}var h=p.gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]),m=p.gf([11803,18811,63136,32407,21693,7032,36364,44957,53757,12789,64713,3900,18604,11139,12735,14185]),b=p.gf([16618,32861,64938,39368,29374,23105,5655,40239,55360,65025,31633,5826,64674,53167,35077,30828]),_=p.gf([49526,37983,2497,57980,13583,52574,41272,11393,57316,48752,43997,39316,57559,45747,29352,656]),y=p.gf([19744,17645,23210,12717,6553,45086,18988,53918,20203,21147,54063,19676,8769,63084,45946,22888]);function d(f){var r=new Uint8Array(32);p.pack25519(r,f);for(var n=1,a=0;a<32;a++)n&=0==r[a];return n}function Z(f,r,n){for(var a,t=-n,g=0;g<16;g++)a=f[g]^r[g],a&=t,f[g]^=a}function F(f){var r=new Uint8Array(32);return p.pack25519(r,f),1&r[0]}function S(f,r){p.Z(f,p.gf(),r)}function k(f,r,n){var a=p.gf();S(a,r),p.set25519(f,r),Z(f,a,n)}function I(f,r){k(f,r,F(r))}function L(f,r,n){var a,t,g,e=p.gf(),o=p.gf(),u=p.gf(),i=p.gf(),c=p.gf(),s=p.gf();return p.S(e,n),p.M(e,e,n),p.S(f,e),p.M(f,f,n),p.M(f,f,r),p.pow2523(f,f),p.M(f,f,e),p.M(f,f,r),p.S(o,f),p.M(o,o,n),p.Z(u,o,r),p.A(i,o,r),p.M(c,r,h),p.A(c,o,c),a=d(u),t=d(i),g=d(c),p.M(s,f,h),Z(f,s,t|g),I(f,f),a|t}function u(f){var r,n=p.gf(),a=p.gf(),t=p.gf(),g=p.gf(),e=p.gf(),o=p.gf(),u=p.gf(),i=(p.gf(),p.gf()),c=p.gf(),s=p.gf(),l=p.gf(),d=p.gf(),M=p.gf(),v=p.gf(),w=p.gf(),m=p.gf(),_=p.gf(),y=new Uint8Array(32);return p.A(s,f[2],f[1]),p.Z(_,f[2],f[1]),p.M(s,s,_),p.M(l,f[0],f[1]),p.S(d,l),p.M(d,s,d),L(e,A,d),p.M(n,e,s),p.M(a,e,l),p.M(m,n,a),p.M(m,m,f[3]),p.M(o,f[0],h),p.M(u,f[1],h),p.M(g,n,b),p.M(c,f[3],m),r=F(c),M=p.gf(f[0]),v=p.gf(f[1]),t=p.gf(a),Z(M,u,r),Z(v,o,r),Z(t,g,r),p.M(w,M,m),k(v,v,F(w)),p.Z(i,f[2],v),p.M(i,t,i),I(i,i),p.pack25519(y,i),y}function i(f,r){var n,a=p.gf(),t=p.gf(),g=p.gf(),e=p.gf(),o=p.gf(),u=p.gf(),i=p.gf(),c=p.gf(),s=p.gf(),l=p.gf();return 0==function(f){var r,n;for(r=127&f[31]^127,n=30;0<n;n--)r|=255^f[n];return 1-(1&((r=(0|r)-1>>8)&236-(0|f[0])>>8|f[0]))}(r)?-1:(p.unpack25519(g,r),p.S(e,g),p.set25519(o,A),p.Z(o,o,e),p.S(i,o),p.set25519(u,A),p.A(u,u,e),p.S(c,u),p.M(s,p.D,i),S(s,s),p.Z(s,s,c),p.M(l,s,c),p.set25519(t,A),n=L(a,t,l),p.M(f[0],a,u),p.M(f[1],a,f[0]),p.M(f[1],f[1],s),p.M(f[0],f[0],g),p.A(f[0],f[0],f[0]),I(f[0],f[0]),p.M(f[1],o,f[1]),p.set25519(f[2],A),p.M(f[3],f[0],f[1]),-(1-n|F(f[3])|d(f[1])))}function c(f,r){var n,a=p.gf(),t=p.gf(),g=p.gf(),e=p.gf(),o=p.gf(),u=p.gf(),i=p.gf(),c=p.gf(),s=p.gf(),l=p.gf(),d=p.gf(),M=p.gf(),v=p.gf(),w=p.gf();p.set25519(g,A),p.S(e,r),p.M(e,h,e),p.A(s,e,g),p.M(s,s,_),p.set25519(a,A),S(a,a),p.A(o,e,p.D),p.M(l,e,p.D),p.Z(l,a,l),p.M(l,l,o),n=1-L(u,s,l),p.M(i,u,r),I(i,i),S(i,i),Z(u,i,n),Z(a,e,n),p.Z(t,e,g),p.M(t,t,a),p.M(t,t,y),p.Z(t,t,l),p.A(d,u,u),p.M(d,d,l),p.M(M,t,m),p.S(c,u),p.Z(v,g,c),p.A(w,g,c),p.M(f[0],d,w),p.M(f[1],v,M),p.M(f[2],M,w),p.M(f[3],d,v)}function r(f){var r=p.gf(),n=p.gf(),a=[p.gf(),p.gf(),p.gf(),p.gf()],t=[p.gf(),p.gf(),p.gf(),p.gf()];return p.unpack25519(r,f.slice(0,32)),p.unpack25519(n,f.slice(32,64)),c(a,r),c(t,n),p.add(a,t),a}function s(f,r){var n=p.gf();S(n,r[3]);var a=p.gf();S(a,r[0]);var t=[a,r[1],r[2],n];p.add(f,t)}function n(){return r(e.randomBytes(64))}function t(f){var r,n=new Float64Array(64);for(r=0;r<32;r++)n[r]=f[r];p.modL(f,n)}function a(f){var r,n=new Float64Array(32);for(r=0;r<32;r++)n[r]=-f[r];return t(n),n}function l(f,r){var n,a=new Float64Array(32);for(n=0;n<32;n++)a[n]=f[n]+r[n];return t(a),a}return f.scalarmult_base=function(f){var r=[p.gf(),p.gf(),p.gf(),p.gf()];return p.scalarbase(r,f),u(r)},f.scalarmult=function(f,r){var n=[p.gf(),p.gf(),p.gf(),p.gf()],a=[p.gf(),p.gf(),p.gf(),p.gf()];if(0!=i(a,r))throw"Invalid argument";return p.scalarmult(n,a,f),u(n)},f.is_valid=function(f){return-1==i([p.gf(),p.gf(),p.gf(),p.gf()],f)?0:1},f.add=function(f,r){var n=[p.gf(),p.gf(),p.gf(),p.gf()],a=[p.gf(),p.gf(),p.gf(),p.gf()];if(-1==i(n,f))throw"Invalid argument";if(-1==i(a,r))throw"Invalid argument";var t=[n[0],n[1],n[2],n[3]];return p.add(t,a),u(t)},f.sub=function(f,r){var n=[p.gf(),p.gf(),p.gf(),p.gf()],a=[p.gf(),p.gf(),p.gf(),p.gf()];if(-1==i(n,f))throw"Invalid argument";if(-1==i(a,r))throw"Invalid argument";var t=[n[0],n[1],n[2],n[3]];return s(t,a),u(t)},f.from_hash=function(f){return u(r(f))},f.random=function(){return u(n())},f.scalar_random=function(){var f=new Uint8Array(32),r=0;do{(f=e.randomBytes(32))[31]&=31;for(var n=32,a=1;r|=f[--n]-p.L[n]>>8&a,a&=(f[n]^p.L[n])-1>>8,0!=n;);}while(0==r);var t,g=new Float64Array(32);for(t=0;t<32;t++)g[t]=f[t];return g},f.scalar_invert=function(f){var r=new Float64Array(32);return function(f,r){var n,a,t=new Float64Array(32);for(n=0;n<32;n++)t[n]=r[n];for(n=251;0<=n;n--)o(t,a=t,a),0!=(g[n>>3]>>>(7&n)&1)&&o(t,t,r);for(n=0;n<32;n++)f[n]=t[n]}(r,f),r},f.scalar_negate=a,f.scalar_add=l,f.scalar_sub=function(f,r){return l(f,a(r))},f.scalar_mul=function(f,r){var n=new Float64Array(32);return o(n,f,r),n},f.unsafe_point_from_hash=r,f.unsafe_tobytes=u,f.unsafe_frombytes=i,f.unsafe_point_sub=s,f.unsafe_point_add=p.add,f.unsafe_point_scalarmult_base=p.scalarbase,f.unsafe_point_scalarmult=p.scalarmult,f.unsafe_point_random=n,f.unsafe_gf=p.gf,f});

!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(r=r||self).ristretto=n()}(this,function(){"use strict";var f={},m=function(r,n){this.hi=0|r,this.lo=0|n},p=function(r){var n,e=new Float64Array(16);if(r)for(n=0;n<r.length;n++)e[n]=r[n];return e},a=function(){throw new Error("no PRNG")},o=new Uint8Array(16),e=new Uint8Array(32);e[0]=9;var A=p(),b=p([1]),h=p([56129,1]),d=p([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=p([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),t=p([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),i=p([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),U=p([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function g(r,n){return r<<n|r>>>32-n}function s(r,n){var e=255&r[n+3];return(e=(e=e<<8|255&r[n+2])<<8|255&r[n+1])<<8|255&r[n+0]}function x(r,n){var e=r[n]<<24|r[n+1]<<16|r[n+2]<<8|r[n+3],t=r[n+4]<<24|r[n+5]<<16|r[n+6]<<8|r[n+7];return new m(e,t)}function l(r,n,e){var t;for(t=0;t<4;t++)r[n+t]=255&e,e>>>=8}function S(r,n,e){r[n]=e.hi>>24&255,r[n+1]=e.hi>>16&255,r[n+2]=e.hi>>8&255,r[n+3]=255&e.hi,r[n+4]=e.lo>>24&255,r[n+5]=e.lo>>16&255,r[n+6]=e.lo>>8&255,r[n+7]=255&e.lo}function u(r,n,e,t,o){var f,a=0;for(f=0;f<o;f++)a|=r[n+f]^e[t+f];return(1&a-1>>>8)-1}function c(r,n,e,t){return u(r,n,e,t,16)}function E(r,n,e,t){return u(r,n,e,t,32)}function w(r,n,e,t,o){var f,a,i,u=new Uint32Array(16),c=new Uint32Array(16),w=new Uint32Array(16),y=new Uint32Array(4);for(f=0;f<4;f++)c[5*f]=s(t,4*f),c[1+f]=s(e,4*f),c[6+f]=s(n,4*f),c[11+f]=s(e,16+4*f);for(f=0;f<16;f++)w[f]=c[f];for(f=0;f<20;f++){for(a=0;a<4;a++){for(i=0;i<4;i++)y[i]=c[(5*a+4*i)%16];for(y[1]^=g(y[0]+y[3]|0,7),y[2]^=g(y[1]+y[0]|0,9),y[3]^=g(y[2]+y[1]|0,13),y[0]^=g(y[3]+y[2]|0,18),i=0;i<4;i++)u[4*a+(a+i)%4]=y[i]}for(i=0;i<16;i++)c[i]=u[i]}if(o){for(f=0;f<16;f++)c[f]=c[f]+w[f]|0;for(f=0;f<4;f++)c[5*f]=c[5*f]-s(t,4*f)|0,c[6+f]=c[6+f]-s(n,4*f)|0;for(f=0;f<4;f++)l(r,4*f,c[5*f]),l(r,16+4*f,c[6+f])}else for(f=0;f<16;f++)l(r,4*f,c[f]+w[f]|0)}function v(r,n,e,t){return w(r,n,e,t,!1),0}function _(r,n,e,t){return w(r,n,e,t,!0),0}var M=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function B(r,n,e,t,o,f,a){var i,u,c=new Uint8Array(16),w=new Uint8Array(64);if(!o)return 0;for(u=0;u<16;u++)c[u]=0;for(u=0;u<8;u++)c[u]=f[u];for(;64<=o;){for(v(w,c,a,M),u=0;u<64;u++)r[n+u]=(e?e[t+u]:0)^w[u];for(i=1,u=8;u<16;u++)i=i+(255&c[u])|0,c[u]=255&i,i>>>=8;o-=64,n+=64,e&&(t+=64)}if(0<o)for(v(w,c,a,M),u=0;u<o;u++)r[n+u]=(e?e[t+u]:0)^w[u];return 0}function L(r,n,e,t,o){return B(r,n,null,0,e,t,o)}function k(r,n,e,t,o){var f=new Uint8Array(32);return _(f,t,o,M),L(r,n,e,t.subarray(16),f)}function K(r,n,e,t,o,f,a){var i=new Uint8Array(32);return _(i,f,a,M),B(r,n,e,t,o,f.subarray(16),i)}function Y(r,n){var e,t=0;for(e=0;e<17;e++)t=t+(r[e]+n[e]|0)|0,r[e]=255&t,t>>>=8}var T=new Uint32Array([5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,252]);function F(r,n,e,t,o,f){var a,i,u,c,w=new Uint32Array(17),y=new Uint32Array(17),g=new Uint32Array(17),s=new Uint32Array(17),l=new Uint32Array(17);for(u=0;u<17;u++)y[u]=g[u]=0;for(u=0;u<16;u++)y[u]=f[u];for(y[3]&=15,y[4]&=252,y[7]&=15,y[8]&=252,y[11]&=15,y[12]&=252,y[15]&=15;0<o;){for(u=0;u<17;u++)s[u]=0;for(u=0;u<16&&u<o;++u)s[u]=e[t+u];for(s[u]=1,t+=u,o-=u,Y(g,s),i=0;i<17;i++)for(u=w[i]=0;u<17;u++)w[i]=w[i]+g[u]*(u<=i?y[i-u]:320*y[i+17-u]|0)|0;for(i=0;i<17;i++)g[i]=w[i];for(u=c=0;u<16;u++)c=c+g[u]|0,g[u]=255&c,c>>>=8;for(c=c+g[16]|0,g[16]=3&c,c=5*(c>>>2)|0,u=0;u<16;u++)c=c+g[u]|0,g[u]=255&c,c>>>=8;c=c+g[16]|0,g[16]=c}for(u=0;u<17;u++)l[u]=g[u];for(Y(g,T),a=0|-(g[16]>>>7),u=0;u<17;u++)g[u]^=a&(l[u]^g[u]);for(u=0;u<16;u++)s[u]=f[u+16];for(s[16]=0,Y(g,s),u=0;u<16;u++)r[n+u]=g[u];return 0}function Z(r,n,e,t,o,f){var a=new Uint8Array(16);return F(a,0,e,t,o,f),c(r,n,a,0)}function z(r,n,e,t,o){var f;if(e<32)return-1;for(K(r,0,n,0,e,t,o),F(r,16,r,32,e-32,r),f=0;f<16;f++)r[f]=0;return 0}function R(r,n,e,t,o){var f,a=new Uint8Array(32);if(e<32)return-1;if(k(a,0,32,t,o),0!==Z(n,16,n,32,e-32,a))return-1;for(K(r,0,n,0,e,t,o),f=0;f<32;f++)r[f]=0;return 0}function P(r,n){var e;for(e=0;e<16;e++)r[e]=0|n[e]}function N(r){var n,e;for(e=0;e<16;e++)r[e]+=65536,n=Math.floor(r[e]/65536),r[(e+1)*(e<15?1:0)]+=n-1+37*(n-1)*(15===e?1:0),r[e]-=65536*n}function O(r,n,e){for(var t,o=~(e-1),f=0;f<16;f++)t=o&(r[f]^n[f]),r[f]^=t,n[f]^=t}function C(r,n){var e,t,o,f=p(),a=p();for(e=0;e<16;e++)a[e]=n[e];for(N(a),N(a),N(a),t=0;t<2;t++){for(f[0]=a[0]-65517,e=1;e<15;e++)f[e]=a[e]-65535-(f[e-1]>>16&1),f[e-1]&=65535;f[15]=a[15]-32767-(f[14]>>16&1),o=f[15]>>16&1,f[14]&=65535,O(a,f,1-o)}for(e=0;e<16;e++)r[2*e]=255&a[e],r[2*e+1]=a[e]>>8}function I(r,n){var e=new Uint8Array(32),t=new Uint8Array(32);return C(e,r),C(t,n),E(e,0,t,0)}function D(r){var n=new Uint8Array(32);return C(n,r),1&n[0]}function q(r,n){var e;for(e=0;e<16;e++)r[e]=n[2*e]+(n[2*e+1]<<8);r[15]&=32767}function G(r,n,e){var t;for(t=0;t<16;t++)r[t]=n[t]+e[t]|0}function V(r,n,e){var t;for(t=0;t<16;t++)r[t]=n[t]-e[t]|0}function X(r,n,e){var t,o,f=new Float64Array(31);for(t=0;t<31;t++)f[t]=0;for(t=0;t<16;t++)for(o=0;o<16;o++)f[t+o]+=n[t]*e[o];for(t=0;t<15;t++)f[t]+=38*f[t+16];for(t=0;t<16;t++)r[t]=f[t];N(r),N(r)}function j(r,n){X(r,n,n)}function H(r,n){var e,t=p();for(e=0;e<16;e++)t[e]=n[e];for(e=253;0<=e;e--)j(t,t),2!==e&&4!==e&&X(t,t,n);for(e=0;e<16;e++)r[e]=t[e]}function J(r,n){var e,t=p();for(e=0;e<16;e++)t[e]=n[e];for(e=250;0<=e;e--)j(t,t),1!==e&&X(t,t,n);for(e=0;e<16;e++)r[e]=t[e]}function Q(r,n,e){var t,o,f=new Uint8Array(32),a=new Float64Array(80),i=p(),u=p(),c=p(),w=p(),y=p(),g=p();for(o=0;o<31;o++)f[o]=n[o];for(f[31]=127&n[31]|64,f[0]&=248,q(a,e),o=0;o<16;o++)u[o]=a[o],w[o]=i[o]=c[o]=0;for(i[0]=w[0]=1,o=254;0<=o;--o)O(i,u,t=f[o>>>3]>>>(7&o)&1),O(c,w,t),G(y,i,c),V(i,i,c),G(c,u,w),V(u,u,w),j(w,y),j(g,i),X(i,c,i),X(c,u,y),G(y,i,c),V(i,i,c),j(u,i),V(c,w,g),X(i,c,h),G(i,i,w),X(c,c,i),X(i,w,g),X(w,u,a),j(u,y),O(i,u,t),O(c,w,t);for(o=0;o<16;o++)a[o+16]=i[o],a[o+32]=c[o],a[o+48]=u[o],a[o+64]=w[o];var s=a.subarray(32),l=a.subarray(16);return H(s,s),X(l,l,s),C(r,l),0}function W(r,n){return Q(r,n,e)}function $(r,n){return a(n,32),W(r,n)}function rr(r,n,e){var t=new Uint8Array(32);return Q(t,e,n),_(r,o,t,M)}var nr=z,er=R;function tr(){var r,n,e,t=0,o=0,f=0,a=0,i=65535;for(e=0;e<arguments.length;e++)t+=(r=arguments[e].lo)&i,o+=r>>>16,f+=(n=arguments[e].hi)&i,a+=n>>>16;return new m((f+=(o+=t>>>16)>>>16)&i|(a+=f>>>16)<<16,t&i|o<<16)}function or(r,n){return new m(r.hi>>>n,r.lo>>>n|r.hi<<32-n)}function fr(){var r,n=0,e=0;for(r=0;r<arguments.length;r++)n^=arguments[r].lo,e^=arguments[r].hi;return new m(e,n)}function ar(r,n){var e,t,o=32-n;return n<32?(e=r.hi>>>n|r.lo<<o,t=r.lo>>>n|r.hi<<o):n<64&&(e=r.lo>>>n|r.hi<<o,t=r.hi>>>n|r.lo<<o),new m(e,t)}var ir=[new m(1116352408,3609767458),new m(1899447441,602891725),new m(3049323471,3964484399),new m(3921009573,2173295548),new m(961987163,4081628472),new m(1508970993,3053834265),new m(2453635748,2937671579),new m(2870763221,3664609560),new m(3624381080,2734883394),new m(310598401,1164996542),new m(607225278,1323610764),new m(1426881987,3590304994),new m(1925078388,4068182383),new m(2162078206,991336113),new m(2614888103,633803317),new m(3248222580,3479774868),new m(3835390401,2666613458),new m(4022224774,944711139),new m(264347078,2341262773),new m(604807628,2007800933),new m(770255983,1495990901),new m(1249150122,1856431235),new m(1555081692,3175218132),new m(1996064986,2198950837),new m(2554220882,3999719339),new m(2821834349,766784016),new m(2952996808,2566594879),new m(3210313671,3203337956),new m(3336571891,1034457026),new m(3584528711,2466948901),new m(113926993,3758326383),new m(338241895,168717936),new m(666307205,1188179964),new m(773529912,1546045734),new m(1294757372,1522805485),new m(1396182291,2643833823),new m(1695183700,2343527390),new m(1986661051,1014477480),new m(2177026350,1206759142),new m(2456956037,344077627),new m(2730485921,1290863460),new m(2820302411,3158454273),new m(3259730800,3505952657),new m(3345764771,106217008),new m(3516065817,3606008344),new m(3600352804,1432725776),new m(4094571909,1467031594),new m(275423344,851169720),new m(430227734,3100823752),new m(506948616,1363258195),new m(659060556,3750685593),new m(883997877,3785050280),new m(958139571,3318307427),new m(1322822218,3812723403),new m(1537002063,2003034995),new m(1747873779,3602036899),new m(1955562222,1575990012),new m(2024104815,1125592928),new m(2227730452,2716904306),new m(2361852424,442776044),new m(2428436474,593698344),new m(2756734187,3733110249),new m(3204031479,2999351573),new m(3329325298,3815920427),new m(3391569614,3928383900),new m(3515267271,566280711),new m(3940187606,3454069534),new m(4118630271,4000239992),new m(116418474,1914138554),new m(174292421,2731055270),new m(289380356,3203993006),new m(460393269,320620315),new m(685471733,587496836),new m(852142971,1086792851),new m(1017036298,365543100),new m(1126000580,2618297676),new m(1288033470,3409855158),new m(1501505948,4234509866),new m(1607167915,987167468),new m(1816402316,1246189591)];function ur(r,n,e){var t,o,f,a=[],i=[],u=[],c=[];for(o=0;o<8;o++)a[o]=u[o]=x(r,8*o);for(var w,y,g,s,l,h,v,_,p,A,b,d,U,E,M=0;128<=e;){for(o=0;o<16;o++)c[o]=x(n,8*o+M);for(o=0;o<80;o++){for(f=0;f<8;f++)i[f]=u[f];for(t=tr(u[7],fr(ar(E=u[4],14),ar(E,18),ar(E,41)),(p=u[4],A=u[5],b=u[6],void 0,d=p.hi&A.hi^~p.hi&b.hi,U=p.lo&A.lo^~p.lo&b.lo,new m(d,U)),ir[o],c[o%16]),i[7]=tr(t,fr(ar(_=u[0],28),ar(_,34),ar(_,39)),(g=u[0],s=u[1],l=u[2],void 0,h=g.hi&s.hi^g.hi&l.hi^s.hi&l.hi,v=g.lo&s.lo^g.lo&l.lo^s.lo&l.lo,new m(h,v))),i[3]=tr(i[3],t),f=0;f<8;f++)u[(f+1)%8]=i[f];if(o%16==15)for(f=0;f<16;f++)c[f]=tr(c[f],c[(f+9)%16],fr(ar(y=c[(f+1)%16],1),ar(y,8),or(y,7)),fr(ar(w=c[(f+14)%16],19),ar(w,61),or(w,6)))}for(o=0;o<8;o++)u[o]=tr(u[o],a[o]),a[o]=u[o];M+=128,e-=128}for(o=0;o<8;o++)S(r,8*o,a[o]);return e}var cr=new Uint8Array([106,9,230,103,243,188,201,8,187,103,174,133,132,202,167,59,60,110,243,114,254,148,248,43,165,79,245,58,95,29,54,241,81,14,82,127,173,230,130,209,155,5,104,140,43,62,108,31,31,131,217,171,251,65,189,107,91,224,205,25,19,126,33,121]);function wr(r,n,e){var t,o=new Uint8Array(64),f=new Uint8Array(256),a=e;for(t=0;t<64;t++)o[t]=cr[t];for(ur(o,n,e),e%=128,t=0;t<256;t++)f[t]=0;for(t=0;t<e;t++)f[t]=n[a-e+t];for(f[e]=128,f[(e=256-128*(e<112?1:0))-9]=0,S(f,e-8,new m(a/536870912|0,a<<3)),ur(o,f,e),t=0;t<64;t++)r[t]=o[t];return 0}function yr(r,n){var e=p(),t=p(),o=p(),f=p(),a=p(),i=p(),u=p(),c=p(),w=p();V(e,r[1],r[0]),V(w,n[1],n[0]),X(e,e,w),G(t,r[0],r[1]),G(w,n[0],n[1]),X(t,t,w),X(o,r[3],n[3]),X(o,o,y),X(f,r[2],n[2]),G(f,f,f),V(a,t,e),V(i,f,o),G(u,f,o),G(c,t,e),X(r[0],a,i),X(r[1],c,u),X(r[2],u,i),X(r[3],a,c)}function gr(r,n,e){var t;for(t=0;t<4;t++)O(r[t],n[t],e)}function sr(r,n){var e=p(),t=p(),o=p();H(o,n[2]),X(e,n[0],o),X(t,n[1],o),C(r,t),r[31]^=D(e)<<7}function lr(r,n,e){var t,o;for(P(r[0],A),P(r[1],b),P(r[2],b),P(r[3],A),o=255;0<=o;--o)gr(r,n,t=e[o/8|0]>>(7&o)&1),yr(n,r),yr(r,r),gr(r,n,t)}function hr(r,n){var e=[p(),p(),p(),p()];P(e[0],t),P(e[1],i),P(e[2],b),X(e[3],t,i),lr(r,e,n)}function vr(r,n,e){var t,o=new Uint8Array(64),f=[p(),p(),p(),p()];for(e||a(n,32),wr(o,n,32),o[0]&=248,o[31]&=127,o[31]|=64,hr(f,o),sr(r,f),t=0;t<32;t++)n[t+32]=r[t];return 0}var _r=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function pr(r,n){var e,t,o,f;for(t=63;32<=t;--t){for(e=0,o=t-32,f=t-12;o<f;++o)n[o]+=e-16*n[t]*_r[o-(t-32)],e=n[o]+128>>8,n[o]-=256*e;n[o]+=e,n[t]=0}for(o=e=0;o<32;o++)n[o]+=e-(n[31]>>4)*_r[o],e=n[o]>>8,n[o]&=255;for(o=0;o<32;o++)n[o]-=e*_r[o];for(t=0;t<32;t++)n[t+1]+=n[t]>>8,r[t]=255&n[t]}function Ar(r){var n,e=new Float64Array(64);for(n=0;n<64;n++)e[n]=r[n];for(n=0;n<64;n++)r[n]=0;pr(r,e)}function br(r,n,e,t){var o,f,a=new Uint8Array(64),i=new Uint8Array(64),u=new Uint8Array(64),c=new Float64Array(64),w=[p(),p(),p(),p()];wr(a,t,32),a[0]&=248,a[31]&=127,a[31]|=64;var y=e+64;for(o=0;o<e;o++)r[64+o]=n[o];for(o=0;o<32;o++)r[32+o]=a[32+o];for(wr(u,r.subarray(32),e+32),Ar(u),hr(w,u),sr(r,w),o=32;o<64;o++)r[o]=t[o];for(wr(i,r,e+64),Ar(i),o=0;o<64;o++)c[o]=0;for(o=0;o<32;o++)c[o]=u[o];for(o=0;o<32;o++)for(f=0;f<32;f++)c[o+f]+=i[o]*a[f];return pr(r.subarray(32),c),y}function dr(r,n,e,t){var o,f,a,i,u,c,w,y,g,s,l=new Uint8Array(32),h=new Uint8Array(64),v=[p(),p(),p(),p()],_=[p(),p(),p(),p()];if(e<64)return-1;if(f=_,a=t,i=p(),u=p(),c=p(),w=p(),y=p(),g=p(),s=p(),P(f[2],b),q(f[1],a),j(c,f[1]),X(w,c,d),V(c,c,f[2]),G(w,f[2],w),j(y,w),j(g,y),X(s,g,y),X(i,s,c),X(i,i,w),J(i,i),X(i,i,c),X(i,i,w),X(i,i,w),X(f[0],i,w),j(u,f[0]),X(u,u,w),I(u,c)&&X(f[0],f[0],U),j(u,f[0]),X(u,u,w),I(u,c)?-1:(D(f[0])===a[31]>>7&&V(f[0],A,f[0]),X(f[3],f[0],f[1]),0))return-1;for(o=0;o<e;o++)r[o]=n[o];for(o=0;o<32;o++)r[o+32]=t[o];if(wr(h,r,e),Ar(h),lr(v,_,h),hr(_,n.subarray(32)),yr(v,_),sr(l,v),e-=64,E(n,0,l,0)){for(o=0;o<e;o++)r[o]=0;return-1}for(o=0;o<e;o++)r[o]=n[o+64];return e}var Ur;function Er(r,n){if(32!==r.length)throw new Error("bad key size");if(24!==n.length)throw new Error("bad nonce size")}function Mr(){for(var r=0;r<arguments.length;r++)if(!(arguments[r]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function mr(r){for(var n=0;n<r.length;n++)r[n]=0}f.lowlevel={crypto_core_hsalsa20:_,crypto_stream_xor:K,crypto_stream:k,crypto_stream_salsa20_xor:B,crypto_stream_salsa20:L,crypto_onetimeauth:F,crypto_onetimeauth_verify:Z,crypto_verify_16:c,crypto_verify_32:E,crypto_secretbox:z,crypto_secretbox_open:R,crypto_scalarmult:Q,crypto_scalarmult_base:W,crypto_box_beforenm:rr,crypto_box_afternm:nr,crypto_box:function(r,n,e,t,o,f){var a=new Uint8Array(32);return rr(a,o,f),nr(r,n,e,t,a)},crypto_box_open:function(r,n,e,t,o,f){var a=new Uint8Array(32);return rr(a,o,f),er(r,n,e,t,a)},crypto_box_keypair:$,crypto_hash:wr,crypto_sign:br,crypto_sign_keypair:vr,crypto_sign_open:dr,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:64,crypto_sign_PUBLICKEYBYTES:32,crypto_sign_SECRETKEYBYTES:64,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:p,D:d,L:_r,pack25519:C,unpack25519:q,M:X,A:G,S:j,Z:V,pow2523:J,add:yr,set25519:P,modL:pr,scalarmult:lr,scalarbase:hr},f.randomBytes=function(r){var n=new Uint8Array(r);return a(n,r),n},f.secretbox=function(r,n,e){Mr(r,n,e),Er(e,n);for(var t=new Uint8Array(32+r.length),o=new Uint8Array(t.length),f=0;f<r.length;f++)t[f+32]=r[f];return z(o,t,t.length,n,e),o.subarray(16)},f.secretbox.open=function(r,n,e){Mr(r,n,e),Er(e,n);for(var t=new Uint8Array(16+r.length),o=new Uint8Array(t.length),f=0;f<r.length;f++)t[f+16]=r[f];return t.length<32?null:0!==R(o,t,t.length,n,e)?null:o.subarray(32)},f.secretbox.keyLength=32,f.secretbox.nonceLength=24,f.secretbox.overheadLength=16,f.scalarMult=function(r,n){if(Mr(r,n),32!==r.length)throw new Error("bad n size");if(32!==n.length)throw new Error("bad p size");var e=new Uint8Array(32);return Q(e,r,n),e},f.scalarMult.base=function(r){if(Mr(r),32!==r.length)throw new Error("bad n size");var n=new Uint8Array(32);return W(n,r),n},f.scalarMult.scalarLength=32,f.scalarMult.groupElementLength=32,f.box=function(r,n,e,t){var o=f.box.before(e,t);return f.secretbox(r,n,o)},f.box.before=function(r,n){Mr(r,n),function(r,n){if(32!==r.length)throw new Error("bad public key size");if(32!==n.length)throw new Error("bad secret key size")}(r,n);var e=new Uint8Array(32);return rr(e,r,n),e},f.box.after=f.secretbox,f.box.open=function(r,n,e,t){var o=f.box.before(e,t);return f.secretbox.open(r,n,o)},f.box.open.after=f.secretbox.open,f.box.keyPair=function(){var r=new Uint8Array(32),n=new Uint8Array(32);return $(r,n),{publicKey:r,secretKey:n}},f.box.keyPair.fromSecretKey=function(r){if(Mr(r),32!==r.length)throw new Error("bad secret key size");var n=new Uint8Array(32);return W(n,r),{publicKey:n,secretKey:new Uint8Array(r)}},f.box.publicKeyLength=32,f.box.secretKeyLength=32,f.box.sharedKeyLength=32,f.box.nonceLength=24,f.box.overheadLength=f.secretbox.overheadLength,f.sign=function(r,n){if(Mr(r,n),64!==n.length)throw new Error("bad secret key size");var e=new Uint8Array(64+r.length);return br(e,r,r.length,n),e},f.sign.open=function(r,n){if(Mr(r,n),32!==n.length)throw new Error("bad public key size");var e=new Uint8Array(r.length),t=dr(e,r,r.length,n);if(t<0)return null;for(var o=new Uint8Array(t),f=0;f<o.length;f++)o[f]=e[f];return o},f.sign.detached=function(r,n){for(var e=f.sign(r,n),t=new Uint8Array(64),o=0;o<t.length;o++)t[o]=e[o];return t},f.sign.detached.verify=function(r,n,e){if(Mr(r,n,e),64!==n.length)throw new Error("bad signature size");if(32!==e.length)throw new Error("bad public key size");var t,o=new Uint8Array(64+r.length),f=new Uint8Array(64+r.length);for(t=0;t<64;t++)o[t]=n[t];for(t=0;t<r.length;t++)o[t+64]=r[t];return 0<=dr(f,o,o.length,e)},f.sign.keyPair=function(){var r=new Uint8Array(32),n=new Uint8Array(64);return vr(r,n),{publicKey:r,secretKey:n}},f.sign.keyPair.fromSecretKey=function(r){if(Mr(r),64!==r.length)throw new Error("bad secret key size");for(var n=new Uint8Array(32),e=0;e<n.length;e++)n[e]=r[32+e];return{publicKey:n,secretKey:new Uint8Array(r)}},f.sign.keyPair.fromSeed=function(r){if(Mr(r),32!==r.length)throw new Error("bad seed size");for(var n=new Uint8Array(32),e=new Uint8Array(64),t=0;t<32;t++)e[t]=r[t];return vr(n,e,!0),{publicKey:n,secretKey:e}},f.sign.publicKeyLength=32,f.sign.secretKeyLength=64,f.sign.seedLength=32,f.sign.signatureLength=64,f.hash=function(r){Mr(r);var n=new Uint8Array(64);return wr(n,r,r.length),n},f.hash.hashLength=64,f.verify=function(r,n){return Mr(r,n),0!==r.length&&0!==n.length&&(r.length===n.length&&0===u(r,0,n,0,r.length))},f.setPRNG=function(r){a=r},function(){var o="undefined"!=typeof self?self.crypto||self.msCrypto:null;if(o&&o.getRandomValues){f.setPRNG(function(r,n){var e,t=new Uint8Array(n);for(e=0;e<n;e+=65536)o.getRandomValues(t.subarray(e,e+Math.min(n-e,65536)));for(e=0;e<n;e++)r[e]=t[e];mr(t)})}else"undefined"!=typeof require&&(o=require("crypto"))&&o.randomBytes&&f.setPRNG(function(r,n){var e,t=o.randomBytes(n);for(e=0;e<n;e++)r[e]=t[e];mr(t)})}(),Ur="undefined"!=typeof require?require("crypto"):window.crypto;var r={},xr=f.lowlevel,Sr=xr.gf([1]),Br=new Float64Array([235,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Lr(r,n,e){var t,o,f=new Float64Array(64);for(t=0;t<64;t++)f[t]=0;for(t=0;t<32;t++)for(o=0;o<32;o++)f[t+o]+=n[t]*e[o];var a=0;for(o=0;o<64;o++)f[o]+=a,a=f[o]>>8,f[o]&=255;xr.modL(r,f)}var kr=xr.gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]),Kr=xr.gf([11803,18811,63136,32407,21693,7032,36364,44957,53757,12789,64713,3900,18604,11139,12735,14185]),Yr=xr.gf([16618,32861,64938,39368,29374,23105,5655,40239,55360,65025,31633,5826,64674,53167,35077,30828]),Tr=xr.gf([49526,37983,2497,57980,13583,52574,41272,11393,57316,48752,43997,39316,57559,45747,29352,656]),Fr=xr.gf([19744,17645,23210,12717,6553,45086,18988,53918,20203,21147,54063,19676,8769,63084,45946,22888]);function Zr(r){var n=new Uint8Array(32);xr.pack25519(n,r);for(var e=1,t=0;t<32;t++)e&=0==n[t];return e}function zr(r,n,e){for(var t,o=-e,f=0;f<16;f++)t=r[f]^n[f],t&=o,r[f]^=t}function Rr(r){var n=new Uint8Array(32);return xr.pack25519(n,r),1&n[0]}function Pr(r,n){xr.Z(r,xr.gf(),n)}function Nr(r,n,e){var t=xr.gf();Pr(t,n),xr.set25519(r,n),zr(r,t,e)}function Or(r,n){Nr(r,n,Rr(n))}function Cr(r,n,e){var t,o,f,a=xr.gf(),i=xr.gf(),u=xr.gf(),c=xr.gf(),w=xr.gf(),y=xr.gf();return xr.S(a,e),xr.M(a,a,e),xr.S(r,a),xr.M(r,r,e),xr.M(r,r,n),xr.pow2523(r,r),xr.M(r,r,a),xr.M(r,r,n),xr.S(i,r),xr.M(i,i,e),xr.Z(u,i,n),xr.A(c,i,n),xr.M(w,n,kr),xr.A(w,i,w),t=Zr(u),o=Zr(c),f=Zr(w),xr.M(y,r,kr),zr(r,y,o|f),Or(r,r),t|o}function Ir(r){var n,e=xr.gf(),t=xr.gf(),o=xr.gf(),f=xr.gf(),a=xr.gf(),i=xr.gf(),u=xr.gf(),c=(xr.gf(),xr.gf()),w=xr.gf(),y=xr.gf(),g=xr.gf(),s=xr.gf(),l=xr.gf(),h=xr.gf(),v=xr.gf(),_=xr.gf(),p=xr.gf(),A=new Uint8Array(32);return xr.A(y,r[2],r[1]),xr.Z(p,r[2],r[1]),xr.M(y,y,p),xr.M(g,r[0],r[1]),xr.S(s,g),xr.M(s,y,s),Cr(a,Sr,s),xr.M(e,a,y),xr.M(t,a,g),xr.M(_,e,t),xr.M(_,_,r[3]),xr.M(i,r[0],kr),xr.M(u,r[1],kr),xr.M(f,e,Yr),xr.M(w,r[3],_),n=Rr(w),l=xr.gf(r[0]),h=xr.gf(r[1]),o=xr.gf(t),zr(l,u,n),zr(h,i,n),zr(o,f,n),xr.M(v,l,_),Nr(h,h,Rr(v)),xr.Z(c,r[2],h),xr.M(c,o,c),Or(c,c),xr.pack25519(A,c),A}function Dr(r,n){var e,t=xr.gf(),o=xr.gf(),f=xr.gf(),a=xr.gf(),i=xr.gf(),u=xr.gf(),c=xr.gf(),w=xr.gf(),y=xr.gf(),g=xr.gf();return 0==function(r){var n,e;for(n=127&r[31]^127,e=30;0<e;e--)n|=255^r[e];return 1-(1&((n=(0|n)-1>>8)&236-(0|r[0])>>8|r[0]))}(n)?-1:(xr.unpack25519(f,n),xr.S(a,f),xr.set25519(i,Sr),xr.Z(i,i,a),xr.S(c,i),xr.set25519(u,Sr),xr.A(u,u,a),xr.S(w,u),xr.M(y,xr.D,c),Pr(y,y),xr.Z(y,y,w),xr.M(g,y,w),xr.set25519(o,Sr),e=Cr(t,o,g),xr.M(r[0],t,u),xr.M(r[1],t,r[0]),xr.M(r[1],r[1],y),xr.M(r[0],r[0],f),xr.A(r[0],r[0],r[0]),Or(r[0],r[0]),xr.M(r[1],i,r[1]),xr.set25519(r[2],Sr),xr.M(r[3],r[0],r[1]),-(1-e|Rr(r[3])|Zr(r[1])))}function qr(r,n){var e,t=xr.gf(),o=xr.gf(),f=xr.gf(),a=xr.gf(),i=xr.gf(),u=xr.gf(),c=xr.gf(),w=xr.gf(),y=xr.gf(),g=xr.gf(),s=xr.gf(),l=xr.gf(),h=xr.gf(),v=xr.gf();xr.set25519(f,Sr),xr.S(a,n),xr.M(a,kr,a),xr.A(y,a,f),xr.M(y,y,Tr),xr.set25519(t,Sr),Pr(t,t),xr.A(i,a,xr.D),xr.M(g,a,xr.D),xr.Z(g,t,g),xr.M(g,g,i),e=1-Cr(u,y,g),xr.M(c,u,n),Or(c,c),Pr(c,c),zr(u,c,e),zr(t,a,e),xr.Z(o,a,f),xr.M(o,o,t),xr.M(o,o,Fr),xr.Z(o,o,g),xr.A(s,u,u),xr.M(s,s,g),xr.M(l,o,Kr),xr.S(w,u),xr.Z(h,f,w),xr.A(v,f,w),xr.M(r[0],s,v),xr.M(r[1],h,l),xr.M(r[2],l,v),xr.M(r[3],s,h)}function n(r){var n=xr.gf(),e=xr.gf(),t=[xr.gf(),xr.gf(),xr.gf(),xr.gf()],o=[xr.gf(),xr.gf(),xr.gf(),xr.gf()];return xr.unpack25519(n,r.slice(0,32)),xr.unpack25519(e,r.slice(32,64)),qr(t,n),qr(o,e),xr.add(t,o),t}function Gr(r,n){var e=xr.gf();Pr(e,n[3]);var t=xr.gf();Pr(t,n[0]);var o=[t,n[1],n[2],e];xr.add(r,o)}function Vr(){return n(Ur.randomBytes(64))}function Xr(r){var n,e=new Float64Array(64);for(n=0;n<32;n++)e[n]=r[n];xr.modL(r,e)}function jr(r){var n,e=new Float64Array(32);for(n=0;n<32;n++)e[n]=-r[n];return Xr(e),e}function Hr(r,n){var e,t=new Float64Array(32);for(e=0;e<32;e++)t[e]=r[e]+n[e];return Xr(t),t}return r.crypto_scalarmult_ristretto255_base=function(r){var n=[xr.gf(),xr.gf(),xr.gf(),xr.gf()];return xr.scalarbase(n,r),Ir(n)},r.crypto_scalarmult_ristretto255=function(r,n){var e=[xr.gf(),xr.gf(),xr.gf(),xr.gf()],t=[xr.gf(),xr.gf(),xr.gf(),xr.gf()];if(0!=Dr(t,n))throw"Invalid argument";return xr.scalarmult(e,t,r),Ir(e)},r.crypto_core_ristretto255_is_valid_point=function(r){return-1==Dr([xr.gf(),xr.gf(),xr.gf(),xr.gf()],r)?0:1},r.crypto_core_ristretto255_add=function(r,n){var e=[xr.gf(),xr.gf(),xr.gf(),xr.gf()],t=[xr.gf(),xr.gf(),xr.gf(),xr.gf()];if(-1==Dr(e,r))throw"Invalid argument";if(-1==Dr(t,n))throw"Invalid argument";var o=[e[0],e[1],e[2],e[3]];return xr.add(o,t),Ir(o)},r.crypto_core_ristretto255_sub=function(r,n){var e=[xr.gf(),xr.gf(),xr.gf(),xr.gf()],t=[xr.gf(),xr.gf(),xr.gf(),xr.gf()];if(-1==Dr(e,r))throw"Invalid argument";if(-1==Dr(t,n))throw"Invalid argument";var o=[e[0],e[1],e[2],e[3]];return Gr(o,t),Ir(o)},r.crypto_core_ristretto255_from_hash=function(r){return Ir(n(r))},r.crypto_core_ristretto255_random=function(){return Ir(Vr())},r.crypto_core_ristretto255_scalar_random=function(){var r;do{(r=Ur.randomBytes(32))[31]&=31;for(var n=32,e=1,t=0;t|=r[--n]-xr.L[n]>>8&e,e&=(r[n]^xr.L[n])-1>>8,0!=n;);}while(0==t);var o=new Float64Array(32);for(n=0;n<32;n++)o[n]=r[n];return o},r.crypto_core_ristretto255_scalar_invert=function(r){var n=new Float64Array(32);return function(r,n){var e,t,o=new Float64Array(32);for(e=0;e<32;e++)o[e]=n[e];for(e=251;0<=e;e--)Lr(o,t=o,t),0!=(Br[e>>3]>>>(7&e)&1)&&Lr(o,o,n);for(e=0;e<32;e++)r[e]=o[e]}(n,r),n},r.crypto_core_ristretto255_scalar_negate=jr,r.crypto_core_ristretto255_scalar_add=Hr,r.crypto_core_ristretto255_scalar_sub=function(r,n){return Hr(r,jr(n))},r.crypto_core_ristretto255_scalar_mul=function(r,n){var e=new Float64Array(32);return Lr(e,r,n),e},r.ristretto255_from_hash=n,r.ristretto255_tobytes=Ir,r.ristretto255_frombytes=Dr,r.sub=Gr,r.ristretto255_random=Vr,r});
